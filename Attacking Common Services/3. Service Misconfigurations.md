# **Service Misconfigurations â€“ Elevation Level 5 (Advanced Attack Framework)**

This document expands the HTB module *Service Misconfigurations* (îˆ€fileciteîˆ‚turn1file0îˆ) into an **advanced red-team framework**.
Ná»™i dung Ä‘Æ°á»£c nÃ¢ng lÃªn cáº¥p chiáº¿n thuáº­t, bao gá»“m:

* Attack Flowcharts
* Exploit Chains
* Red-Team Playbooks
* MITRE & Kill Chain Mapping
* STRIDE Threat Modeling
* Universal Decision Trees
* Case Studies & Practical Examples

---

# **ğŸ“˜ Má»¤C Lá»¤C**

1. [Giá»›i thiá»‡u](#introduction)
2. [Mindmap Elevation Level 5](#mindmap)
3. [Authentication Misconfigurations â€“ Advanced Model](#auth)
4. [Anonymous Access â€“ Advanced Model](#anonymous)
5. [Misconfigured Access Rights â€“ Advanced Model](#access-rights)
6. [Unnecessary Defaults â€“ Advanced Model](#defaults)
7. [Global Exploit Chains](#exploit-chains)
8. [Red-Team Playbooks](#playbooks)
9. [MITRE + Kill Chain Mapping](#mitre)
10. [STRIDE Threat Modeling](#stride)
11. [Universal Misconfiguration Decision Tree](#decision-tree)
12. [Case Studies](#cases)
13. [Defense Mapping](#defense)
14. [Key Takeaways](#key-takeaways)

---

# <a name="introduction"></a> **1. Giá»›i thiá»‡u**

Service Misconfigurations lÃ  **má»™t trong nhá»¯ng nguyÃªn nhÃ¢n hÃ ng Ä‘áº§u** dáº«n Ä‘áº¿n compromise há»‡ thá»‘ng. VÃ¬ má»i service Ä‘á»u:

* cháº¡y vá»›i quyá»n cao,
* nháº­n request tá»« máº¡ng,
* vÃ  phá»¥ thuá»™c vÃ o cáº¥u hÃ¬nh.

**Elevation Level 5** biáº¿n ná»™i dung gá»‘c thÃ nh **framework táº¥n cÃ´ng chiáº¿n thuáº­t**, giÃºp báº¡n hiá»ƒu cÃ¡ch attacker khai thÃ¡c sai cáº¥u hÃ¬nh trong mÃ´i trÆ°á»ng tháº­t.

---

# <a name="mindmap"></a> **2. Mindmap Elevation Level 5 â€“ Service Misconfigurations**

```mermaid
mindmap
  root((Service Misconfigurations L5))
    Authentication
      Default Credentials
      Weak Credentials
      Empty Passwords
    Anonymous Access
      FTP Anonymous
      SMB Guest
      API Anonymous
    Misconfigured Access Rights
      Overprivileged Users
      Overexposed Shares
      Misaligned RBAC/ACL
    Unnecessary Defaults
      Default Settings
      Default Services
      Default Pages
      Debug Enabled
    Preventing Misconfigurations
      Hardening Process
      Minimal Platform
      Patch + Review Cycle
      Segmentation
      Automated Verification
```

---

# <a name="auth"></a> **3. Authentication Misconfigurations â€“ Elevation Level 5**

Misconfigurations include:

* Default credentials: `admin:admin`, `root:123456`
* Weak or temporary passwords left unchanged
* Blank passwords

## **3.1 Attack Flowchart â€“ Authentication**

```
Grab Banner â†’ Identify Service â†’
  â”œâ”€â”€ Known default creds?
  â”œâ”€â”€ Weak passwords?
  â”œâ”€â”€ Empty password allowed?
If YES â†’ Immediate Access
If NO â†’ Switch to password spraying or key-based attacks
```

## **3.2 Exploit Chain â€“ Default Credential Takeover**

```
1. Service exposes login interface
2. Default password unchanged
3. Attacker logs in â†’ service-level control
4. PrivEsc via service permissions
5. Lateral movement from compromised service
```

## **3.3 Red-Team Playbook â€“ Authentication Misconfigs**

* Check banner â†’ look for vendors with known defaults
* Try top 20 weak credentials
* Use password spraying to avoid lockouts
* Try empty passwords on legacy services

## **3.4 Detection Indicators**

* Multiple login attempts to known admin accounts
* Successful login without password

---

# <a name="anonymous"></a> **4. Anonymous Access â€“ Elevation Level 5**

Anonymous access = service cho phÃ©p káº¿t ná»‘i **khÃ´ng cáº§n password**.

* FTP â†’ `ftp anonymous`
* SMB â†’ Guest login
* Web/API â†’ no-auth endpoints

## **4.1 Attack Flowchart â€“ Anonymous Access**

```
Check login requirement â†’
  â”œâ”€â”€ Anonymous allowed?
  â”‚      â”œâ”€â”€ Browse files
  â”‚      â”œâ”€â”€ Read secrets
  â”‚      â””â”€â”€ Upload shells (FTP)
  â””â”€â”€ If anonymous disabled â†’ search misconfig in ACL
```

## **4.2 Exploit Chain â€“ Anonymous Exposure**

```
1. Anonymous login allowed
2. Attacker enumerates directories
3. Sensitive files found (creds, config)
4. Use leaked data to escalate attack
5. Pivot to other services
```

## **4.3 Red-Team Playbook**

* Enumerate anonymously first (no noise)
* Search config backups, DB dumps, SSH keys

## **4.4 Detection Indicators**

* Logins from unauthenticated users
* Anonymous SMB/FTP directory browsing

---

# <a name="access-rights"></a> **5. Misconfigured Access Rights â€“ Elevation Level 5**

Sai quyá»n truy cáº­p lÃ  má»™t trong nhá»¯ng misconfig nguy hiá»ƒm nháº¥t.

## **5.1 Attack Flowchart â€“ Misconfigured Access Rights**

```
Login as low-priv user â†’
  â”œâ”€â”€ Can read privileged directories?
  â”œâ”€â”€ Can upload to sensitive paths?
  â”œâ”€â”€ Overexposed shares?
If YES â†’ escalate using leaked information
If NO â†’ attempt privilege escalation at OS level
```

## **5.2 Exploit Chain â€“ Overprivileged User**

```
1. User has excess privileges
2. Attacker gains access via weak creds
3. Reads sensitive data
4. Finds credentials/configs/logs
5. Uses data to pivot further
```

## **5.3 Red-Team Playbook**

* Search for paths where low-priv users shouldn't have access
* Dump all readable config files
* Download `.env`, `.conf`, backups, logs

## **5.4 Detection Indicators**

* Low-priv users accessing admin folders
* Excessive read/write events

---

# <a name="defaults"></a> **6. Unnecessary Defaults â€“ Elevation Level 5**

Defaults include:

* Default services
* Default accounts
* Debug mode on
* Default pages (setup.php)
* Unneeded components

## **6.1 Attack Flowchart â€“ Defaults Abuse**

```
Service â†’ Check default components â†’
  â”œâ”€â”€ Default credentials?
  â”œâ”€â”€ Default pages?
  â”œâ”€â”€ Default services enabled?
  â”œâ”€â”€ Debug endpoints?
If YES â†’ exploit
If NO â†’ proceed to config enumeration
```

## **6.2 Exploit Chain â€“ Default Component Abuse**

```
1. Default component active
2. Attacker discovers entry point
3. Uses built-in functionality to bypass security
4. Gains shell or retrieves secrets
5. Expands attack surface
```

## **6.3 Red-Team Playbook**

* Scan for default pages (`/admin`, `/setup`, `/phpmyadmin`)
* Test default SNMP communities
* Abuse debug endpoints

## **6.4 Detection Indicators**

* Requests to setup or install pages
* Access to debug or developer URLs

---

# <a name="exploit-chains"></a> **7. Global Exploit Chains**

### **Universal Misconfiguration Exploit Chain**

```
1. Enumeration â†’ Identify weak configuration
2. Leverage weak/passwordless access
3. Extract sensitive data
4. Use data to escalate privileges
5. Pivot to connected services
6. Maintain persistence
7. Exfiltrate data
```

### **Multi-Service Pivot Chain**

```
FTP misconfig â†’ grab DB creds â†’ login SQL â†’ dump user table â†’ login SSH â†’ become root
```

---

# <a name="playbooks"></a> **8. Red-Team Playbooks**

## **8.1 FTP Misconfig Playbook**

* Test anonymous
* Test weak creds
* Attempt write in upload dirs
* Upload webshell if webroot mapped

## **8.2 SMB Misconfig Playbook**

* Test null session
* Enumerate shares
* Find accessible sensi
