# Interacting with Common Services â€“ Mindmap & Advanced Notes

## ğŸ“Œ Má»¥c lá»¥c

1. Mindmap tá»•ng há»£p
2. Mindmap nÃ¢ng cao (thÃªm attack surface)
3. Lá»‡nh quan trá»ng trong tÃ i liá»‡u

   * SMB (Windows CMD / PowerShell / Linux)
   * Email (SMTP/IMAP/POP3)
   * Databases (MSSQL / MySQL / Tools)
4. Ghi chÃº nÃ¢ng cao dÃ nh cho Pentester
5. Key Takeaways

---

# 1. ğŸŒ³ Mindmap tá»•ng há»£p

```
Interacting with Common Services
â”‚
â”œâ”€â”€ 1. File Share Services
â”‚     â”‚
â”‚     â”œâ”€â”€ SMB
â”‚     â”‚      â”œâ”€â”€ Windows GUI (\\IP\Share)
â”‚     â”‚      â”œâ”€â”€ Windows CMD (dir, net use, findstr)
â”‚     â”‚      â”œâ”€â”€ PowerShell (gci, New-PSDrive, Select-String)
â”‚     â”‚      â””â”€â”€ Linux (mount -t cifs, find, grep)
â”‚     â”‚
â”‚     â””â”€â”€ FTP / TFTP / NFS (mount â†’ search)
â”‚
â”œâ”€â”€ 2. Email Services
â”‚     â”œâ”€â”€ SMTP / POP3 / IMAP
â”‚     â”œâ”€â”€ Evolution Mail Client
â”‚     â””â”€â”€ TLS / STARTTLS / Auth types
â”‚
â”œâ”€â”€ 3. Databases
â”‚     â”œâ”€â”€ MSSQL (sqsh, sqlcmd)
â”‚     â”œâ”€â”€ MySQL (mysql / mysql.exe)
â”‚     â””â”€â”€ GUI (dbeaver, Workbench, SSMS)
â”‚
â”œâ”€â”€ 4. Tools
â”‚     â”œâ”€â”€ SMB â†’ smbclient, CME, Impacket
â”‚     â”œâ”€â”€ FTP â†’ ftp, lftp, filezilla
â”‚     â”œâ”€â”€ Email â†’ swaks, mutt, sendmail
â”‚     â””â”€â”€ DB â†’ mycli, mssql-cli, dbeaver
â”‚
â””â”€â”€ 5. Troubleshooting
      â”œâ”€â”€ Authentication issues
      â”œâ”€â”€ Privilege issues
      â”œâ”€â”€ Firewall rules
      â”œâ”€â”€ Network connectivity
      â””â”€â”€ Protocol support
```

---

# 2. ğŸŒ² Mindmap nÃ¢ng cao (kÃ¨m Attack Surface)

```
Common Services (High-level Attack Surface)
â”‚
â”œâ”€â”€ SMB
â”‚     â”œâ”€â”€ Enumeration
â”‚     â”‚      â”œâ”€â”€ List shares
â”‚     â”‚      â”œâ”€â”€ Anonymous access
â”‚     â”‚      â””â”€â”€ Sensitive files (cred, secret, pass, key)
â”‚     â”œâ”€â”€ Misconfig
â”‚     â”‚      â”œâ”€â”€ Weak share ACL
â”‚     â”‚      â”œâ”€â”€ Write access â†’ malware drop
â”‚     â”‚      â””â”€â”€ SUID via network paths
â”‚     â””â”€â”€ Tools
â”‚            â”œâ”€â”€ smbclient
â”‚            â”œâ”€â”€ CrackMapExec
â”‚            â”œâ”€â”€ smbmap
â”‚            â””â”€â”€ Impacket (psexec/smbexec)
â”‚
â”œâ”€â”€ Email
â”‚     â”œâ”€â”€ Attack Surface
â”‚     â”‚      â”œâ”€â”€ Open SMTP relay
â”‚     â”‚      â”œâ”€â”€ Credential brute force
â”‚     â”‚      â””â”€â”€ Misconfig IMAP/POP3
â”‚     â”œâ”€â”€ Enumerate
â”‚     â”‚      â”œâ”€â”€ swaks test
â”‚     â”‚      â”œâ”€â”€ Evolution login
â”‚     â”‚      â””â”€â”€ Check TLS/STARTTLS support
â”‚
â”œâ”€â”€ Databases
â”‚     â”œâ”€â”€ MSSQL
â”‚     â”‚      â”œâ”€â”€ xp_cmdshell (privesc)
â”‚     â”‚      â”œâ”€â”€ weak SA passwords
â”‚     â”‚      â””â”€â”€ open TCP/1433
â”‚     â”œâ”€â”€ MySQL
â”‚     â”‚      â”œâ”€â”€ FILE privilege leakage
â”‚     â”‚      â”œâ”€â”€ weak root auth
â”‚     â”‚      â””â”€â”€ DB creds reused
â”‚     â””â”€â”€ Tools
â”‚            â”œâ”€â”€ mycli/mssql-cli
â”‚            â”œâ”€â”€ dbeaver
â”‚            â””â”€â”€ sqlcmd/mysql.exe
â”‚
â””â”€â”€ General
      â”œâ”€â”€ Authentication
      â”œâ”€â”€ Privileges
      â”œâ”€â”€ Firewall
      â”œâ”€â”€ Connectivity
      â””â”€â”€ Version support (e.g., SMBv1 disabled)
```

---

# 3. ğŸ”§ CÃ¡c cÃ¢u lá»‡nh quan trá»ng trong tÃ i liá»‡u

## 3.1 SMB Commands

### **Windows CMD**

```
dir \\192.168.220.129\Finance
net use n: \\192.168.220.129\Finance
net use n: \\192.168.220.129\Finance /user:plaintext Password123
dir n: /a-d /s /b | find /c ":\"
findstr /s /i cred n:\*.*
```

### **Windows PowerShell**

```
Get-ChildItem \\192.168.220.129\Finance
New-PSDrive -Name "N" -Root "\\192.168.220.129\Finance" -PSProvider FileSystem
# Auth
$username = 'plaintext'
$password = 'Password123'
$secpassword = ConvertTo-SecureString $password -AsPlainText -Force
$cred = New-Object System.Management.Automation.PSCredential $username, $secpassword
New-PSDrive -Name "N" -Root "\\192.168.220.129\Finance" -PSProvider FileSystem -Credential $cred
# Search
(Get-ChildItem -File -Recurse | Measure-Object).Count
Select-String "cred" -Path N:\ -List
```

### **Linux SMB**

```
sudo mkdir /mnt/Finance
sudo mount -t cifs //192.168.220.129/Finance /mnt/Finance -o username=plaintext,password=Password123,domain=.
# Credential file
username=plaintext
password=Password123
domain=.
# Search
find /mnt/Finance/ -name *cred*
grep -rn /mnt/Finance/ -ie cred
```

---

## 3.2 Email Commands / Concepts

KhÃ´ng cÃ³ nhiá»u lá»‡nh CLI trong tÃ i liá»‡u, nhÆ°ng cÃ³ khÃ¡i niá»‡m:

* SMTP (send)
* POP3 (download mail)
* IMAP (sync mail)
* STARTTLS / TLS
* Evolution Mail setup

---

## 3.3 Database Commands

### **MSSQL â€“ sqsh**

```
sqsh -S 10.129.20.13 -U username -P Password123
```

### **MSSQL â€“ sqlcmd**

```
sqlcmd -S 10.129.20.13 -U username -P Password123
```

### **MySQL Linux**

```
mysql -u username -pPassword123 -h 10.129.20.13
```

### **MySQL Windows**

```
mysql.exe -u username -pPassword123 -h 10.129.20.13
```

### **Dbeaver install**

```
sudo dpkg -i dbeaver-<version>.deb
dbeaver &
```

---

# 4. ğŸ¯ NÃ¢ng cao â€“ Ghi chÃº dÃ nh cho Pentester

### **SMB**

* HÃ£y Æ°u tiÃªn kiá»ƒm tra anonymous login trÆ°á»›c.
* TÃ¬m kiáº¿m cÃ¡c keyword phá»• biáº¿n: `password`, `pwd`, `key`, `creds`, `secret`, `.config`, `.php`, `.aspx`.
* Náº¿u share cÃ³ write â†’ thá»­ drop reverse shell hoáº·c thay Ä‘á»•i file.

### **Email**

* Test SMTP relay báº±ng swaks.
* DÃ² TLS support Ä‘á»ƒ biáº¿t server cáº¥u hÃ¬nh yáº¿u.

### **Database**

* MySQL: cá»‘ thá»­ `SELECT LOAD_FILE()` Ä‘á»ƒ Ä‘á»c file há»‡ thá»‘ng.
* MSSQL: kiá»ƒm tra xem cÃ³ `xp_cmdshell` hay khÃ´ng.
* Cred DB thÆ°á»ng reuse â†’ thá»­ login vÃ o SMB/SSH.

### **General**

* Log tráº£ vá» tá»« services giÃºp Ä‘oÃ¡n firewall hoáº·c ACL.
* Náº¿u lá»—i Auth â†’ thá»­ username tá»“n táº¡i + password spray.
* Náº¿u lá»—i Protocol â†’ thá»­ version downgrade.

---

# 5. ğŸ“Œ Key Takeaways

* Náº¯m cÃ¡ch **tÆ°Æ¡ng tÃ¡c** dá»‹ch vá»¥ trÆ°á»›c khi **táº¥n cÃ´ng**.
* SMB, Email, Database lÃ  3 dá»‹ch vá»¥ lá»™ data nhiá»u nháº¥t.
* CÃ´ng cá»¥ OS (find, grep, findstr, Select-String) máº¡nh hÆ¡n GUI.
* ThÃ´ng tin nháº¡y cáº£m náº±m trong file share ráº¥t nhiá»u.
* Dbeaver lÃ  GUI máº¡nh nháº¥t khi enumerate database.
* Hiá»ƒu lá»—i Error code â†’ tÄƒng tá»‘c quÃ¡ trÃ¬nh exploit.

---

**Báº¡n muá»‘n mÃ¬nh xuáº¥t báº£n nÃ¢ng cao hÆ¡n ná»¯a?**

* ThÃªm **flowchart táº¥n cÃ´ng SMB/FTP/SQL**?
* ThÃªm **cheat-sheet lá»‡nh cá»±c ngáº¯n gá»n**?
* ThÃªm **mÃ´ hÃ¬nh attack chain thá»±c chiáº¿n**?
