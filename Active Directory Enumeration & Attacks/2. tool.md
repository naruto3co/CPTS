# Tools of the Trade – Active Directory

## AD Enumeration & Mapping
- **PowerView / SharpView**  
  Enum AD (users, groups, ACLs, SPNs), thay thế net* commands, tìm quick wins.
- **BloodHound**  
  Phân tích quan hệ AD bằng đồ thị (Neo4j), tìm attack path.
- **SharpHound**  
  C# collector cho BloodHound (users, groups, ACLs, sessions, GPOs).
- **BloodHound.py**  
  BloodHound ingestor bằng Python (Impacket), chạy từ máy không join domain.
- **Active Directory Explorer (AD Explorer)**  
  Xem/snapshot AD database, so sánh thay đổi offline.

---

## Kerberos & Authentication Attacks
- **Kerbrute**  
  Enum user, password spraying, brute-force qua Kerberos.
- **Rubeus**  
  Kerberos abuse (tickets, roasting, delegation…).
- **GetUserSPNs.py**  
  Tìm SPN → Kerberoasting.
- **GetNPUsers.py**  
  ASREPRoasting (user không cần pre-auth).
- **ticketer.py**  
  Tạo TGT/TGS (Golden Ticket, trust attacks).
- **gettgtpkinit.py**  
  Abuse certificate / PKINIT.
- **getnthash.py**  
  Lấy NT hash qua U2U.

---

## Credential Capture / Relay
- **Responder**  
  Poison LLMNR / NBT-NS / MDNS để bắt hash.
- **Inveigh.ps1**  
  Phiên bản PowerShell của Responder.
- **InveighZero (C# Inveigh)**  
  Inveigh bản C# có console tương tác.
- **ntlmrelayx.py**  
  SMB/HTTP relay attacks.
- **PetitPotam.py**  
  Coerce authentication qua MS-EFSRPC.

---

## Impacket Toolkit (Core)
- **psexec.py** – Remote shell kiểu PsExec  
- **wmiexec.py** – Command execution qua WMI  
- **secretsdump.py** – Dump SAM/LSA secrets  
- **mssqlclient.py** – Tương tác MSSQL  
- **rpcdump.py** – RPC endpoint mapper  
- **lookupsid.py** – SID brute-force  
- **raiseChild.py** – Child → Parent domain privesc  

---

## SMB / RPC / Network Enumeration
- **rpcinfo**  
  Enum RPC services trên host.
- **rpcclient**  
  Enum AD qua RPC (Samba).
- **enum4linux**  
  Enum Windows/Samba.
- **enum4linux-ng**  
  Phiên bản cải tiến của enum4linux.
- **smbmap**  
  Enum SMB shares & permissions.
- **smbserver.py**  
  SMB server để transfer file.

---

## Password Attacks
- **DomainPasswordSpray.ps1**  
  Password spraying trong domain.
- **Hashcat**  
  Crack hash offline.

---

## Post-Exploitation / Lateral Movement
- **CrackMapExec (CME)**  
  Enum + attack SMB/WMI/WinRM/MSSQL (LotL).
- **evil-winrm**  
  Interactive shell qua WinRM.
- **Mimikatz**  
  Dump creds, pass-the-hash, Kerberos tickets.

---

## LDAP / DNS Enumeration
- **ldapsearch**  
  Query LDAP trực tiếp.
- **windapsearch**  
  Python LDAP enumeration script.
- **adidnsdump**  
  Dump AD-integrated DNS records.

---

## GPO / LAPS / Config Attacks
- **LAPSToolkit**  
  Audit & attack LAPS.
- **gpp-decrypt**  
  Decrypt password trong GPP.
- **Group3r**  
  Audit misconfig GPO.

---

## Vulnerability Exploits
- **noPac.py**  
  CVE-2021-42278 + 42287 → DA impersonation.
- **CVE-2021-1675.py**  
  PrintNightmare PoC.

---

## Recon & Risk Assessment
- **Snaffler**  
  Tìm credential trong file shares.
- **PingCastle**  
  Đánh giá mức độ rủi ro AD.
- **ADRecon**  
  Dump AD data → Excel (overview security posture).
