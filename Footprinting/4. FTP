  _____ _____ ____  
 |  ___|_   _|  _ \ 
 | |_    | | | |_) |
 |  _|   | | |  __/ 
 |_|     |_| |_|    
                    

FTP ch·∫°y trong l·ªõp Application trong m√¥ h√¨nh TCP/IP c√≥ -> v√¨ v·∫≠y n√™n n√≥ ƒë∆∞·ª£c s·ª≠ d·ª•ng nh∆∞ HTTP ho·∫∑c POP 


Khi ta mu·ªën download file ho·∫∑c upload file qua FTP th√¨ 2 channel s·∫Ω ƒë∆∞·ª£c m·ªü ( nh∆∞ h√¨nh d∆∞·ªõi )
           - Client t·∫°o k·∫øt n·ªëi th√¥ng qua port 21 c·ªßa server. Client g·ª≠i c√¢u l·ªánh t·ªõi server v√† server tr·∫£ v·ªÅ status code 
                      Client (51514) <----TCP----> Server (21)           [ 51514 l√† port ng·∫´u nhi√™n c·ªßa client ƒë·ªÉ giao ti·∫øp v·ªõi server ]
           - Khi l√†m b∆∞·ªõc tr√™n xong th√¨ s·∫Ω truy·ªÅn file qua c·ªïng 20 nh√©. C·ªïng 20 s·∫Ω lo vai tr√≤ duy tr√¨ k·∫øt n·ªëi, dataloss, k·∫øt n·ªëi l·∫°i 
           
           
           +----------------------+                     +----------------------+
           |      FTP Client      |                     |      FTP Server      |
           +----------------------+                     +----------------------+
                      |                                          |
                      |    (1) Control Channel - Port 21         |
                      |----------------------------------------->|
                      |  USER, PASS, LIST, RETR, STOR ...        |
                      |<-----------------------------------------|
                      |    Status codes (200, 220, 331, 550...)  |
                      |                                          |
                      |                                          |
                      |    (2) Data Channel - Port 20            |
                      |=========================================>|
                      |       Truy·ªÅn file / d·ªØ li·ªáu th·ª±c t·∫ø      |
                      |<=========================================|
                      |                                          |
                      |  Khi xong: Data channel ƒë√≥ng             |
                      |  Control channel v·∫´n duy tr√¨             |
                      |                                          |


FTP chia th√†nh 2 lo·∫°i 
Active FTP v√† Passive FTP

üîπ Active FTP
           Control channel: Client ‚Üí Server (port 21).
           Data channel: Server ch·ªß ƒë·ªông k·∫øt n·ªëi t·ª´ port 20 c·ªßa n√≥ ƒë·∫øn m·ªôt port ng·∫´u nhi√™n tr√™n client.
           Nh∆∞·ª£c ƒëi·ªÉm: N·∫øu client n·∫±m sau firewall/NAT ‚Üí k·∫øt n·ªëi t·ª´ ngo√†i (server ‚Üí client) th∆∞·ªùng b·ªã ch·∫∑n ‚ùå.
                      Client (ephemeral port) ---> Server:21   [Control channel]
                      Server:20 --------> Client (ephemeral)   [Data channel]


üîπ Passive FTP
           Control channel: Client ‚Üí Server (port 21).
           Data channel: Server b√°o cho client m·ªôt port ng·∫´u nhi√™n >1023 c·ªßa n√≥.
           Client ch·ªß ƒë·ªông k·∫øt n·ªëi ƒë·∫øn port ƒë√≥ tr√™n server.
           ∆Øu ƒëi·ªÉm: V√¨ t·∫•t c·∫£ k·∫øt n·ªëi ƒë·ªÅu do client kh·ªüi t·∫°o ‚Üí √≠t b·ªã firewall ch·∫∑n ‚úÖ.
                      Client (ephemeral port) ---> Server:21       [Control channel]
                      Client (ephemeral port) ---> Server:>1023    [Data channel]


üëâ Kh√°c bi·ªát ch√≠nh:
           Active: server ‚Äúg·ªçi v·ªÅ‚Äù client ‚Üí d·ªÖ b·ªã firewall ch·∫∑n.
           Passive: client ‚Äúg·ªçi ƒëi‚Äù server ‚Üí firewall cho ph√©p d·ªÖ d√†ng h∆°n.



Command list FTP : https://web.archive.org/web/20230326204635/https://www.smartfile.com/blog/the-ultimate-ftp-commands-list/

Kh√¥ng ph·∫£i to√†n b·ªô c√¢u l·ªánh FTP ƒë∆∞·ª£c d√πng ph√≠a server. C√≥ th·ªÉ d√πng t·ª´ client vaf response status code ƒë·ªÉ th√¥ng b√°o c√≥ th√†nh c√¥ng hay kh√¥ng
           Response status : https://en.wikipedia.org/wiki/List_of_FTP_server_return_codes








‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë
‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó
‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù
‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïù‚ñë
‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñë‚ñë
‚ñë‚ñë‚ñë‚ïö‚ïê‚ïù‚ñë‚ñë‚ñë‚ïö‚ïê‚ïù‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ïö‚ïê‚ïù‚ñë‚ñë‚ñë‚ïö‚ïê‚ïù‚ñë‚ñë‚ñë‚ñë‚ñë


Trivial File Transfer Protocol (TFTP) ƒë∆°n gi·∫£n h∆°n FTP. N√™n s·∫Ω kh√¥ng cung c·∫•p x√°c th·ª±c v√† 1 s·ªë t√≠nh nƒÉng kh√°c 
TFTP d√πng UDP thay v√¨ TCP nh∆∞ c·ªßa FTP 

M·ªôt s·ªë l·ªánh TFTP th√¥ng d·ª•ng 
| **Command** | **Description (√ù nghƒ©a)**                                                                             |
| ----------- | ----------------------------------------------------------------------------------------------------- |
| `connect`   | Thi·∫øt l·∫≠p k·∫øt n·ªëi t·ªõi host t·ª´ xa, c√≥ th·ªÉ k√®m c·ªïng ƒë·ªÉ truy·ªÅn file.                                     |
| `get`       | T·∫£i 1 ho·∫∑c nhi·ªÅu file **t·ª´ remote host ‚Üí v·ªÅ local host**.                                             |
| `put`       | Upload 1 ho·∫∑c nhi·ªÅu file **t·ª´ local host ‚Üí l√™n remote host**.                                         |
| `quit`      | Tho√°t kh·ªèi ch∆∞∆°ng tr√¨nh TFTP.                                                                         |
| `status`    | Hi·ªÉn th·ªã tr·∫°ng th√°i hi·ªán t·∫°i c·ªßa TFTP (ch·∫ø ƒë·ªô truy·ªÅn: ascii/binary, t√¨nh tr·∫°ng k·∫øt n·ªëi, time-out...). |
| `verbose`   | B·∫≠t/t·∫Øt ch·∫ø ƒë·ªô hi·ªÉn th·ªã chi ti·∫øt (in th√™m th√¥ng tin trong qu√° tr√¨nh truy·ªÅn file).                     |






Default Configuration

           M·ªôt trong nh∆∞ng m√°y ch·ªß FTP ƒë∆∞·ª£c c√†i tr√™n linux ph·ªï bi·∫øn l√† vsftpd ( c√≥ nhi·ªÅu l·ª±a ch·ªçn kh√°c n·ªØa ) 
           C·∫•u h√¨nh trong file /etc/vsftpd.conf
           
           Install : naruto3co@htb[/htb]$ sudo apt install vsftpd 
vsFTPd Config File
           naruto3co@htb[/htb]$ cat /etc/vsftpd.conf | grep -v "#"

           | **Setting**                                                   | **Description (√ù nghƒ©a)**                                                    |
           | ------------------------------------------------------------- | ---------------------------------------------------------------------------- |
           | `listen=NO`                                                   | Ch·∫°y t·ª´ **inetd/xinetd** (NO) hay ch·∫°y d·∫°ng **standalone daemon** (YES).     |
           | `listen_ipv6=YES`                                             | Cho ph√©p l·∫Øng nghe k·∫øt n·ªëi **IPv6**.                                         |
           | `anonymous_enable=NO`                                         | C√≥ cho ph√©p truy c·∫≠p **anonymous FTP** kh√¥ng (NO = t·∫Øt).                     |
           | `local_enable=YES`                                            | Cho ph√©p **user local trong h·ªá th·ªëng** ƒëƒÉng nh·∫≠p FTP.                        |
           | `dirmessage_enable=YES`                                       | Hi·ªÉn th·ªã **message trong th∆∞ m·ª•c** (n·∫øu c√≥ file `.message`) khi user cd v√†o. |
           | `use_localtime=YES`                                           | S·ª≠ d·ª•ng **gi·ªù local** thay v√¨ UTC khi hi·ªÉn th·ªã file.                         |
           | `xferlog_enable=YES`                                          | B·∫≠t **log** cho ho·∫°t ƒë·ªông upload/download.                                   |
           | `connect_from_port_20=YES`                                    | S·ª≠ d·ª•ng **port 20** ƒë·ªÉ k·∫øt n·ªëi d·ªØ li·ªáu (theo chu·∫©n FTP active mode).         |
           | `secure_chroot_dir=/var/run/vsftpd/empty`                     | Th∆∞ m·ª•c tr·ªëng ƒë·ªÉ **chroot jail** khi vsftpd kh·ªüi ƒë·ªông, nh·∫±m tƒÉng b·∫£o m·∫≠t.    |
           | `pam_service_name=vsftpd`                                     | T√™n d·ªãch v·ª• PAM (Pluggable Authentication Module) ƒë·ªÉ x√°c th·ª±c user.          |
           | `rsa_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem`          | V·ªã tr√≠ file **RSA certificate** d√πng cho SSL/TLS.                            |
           | `rsa_private_key_file=/etc/ssl/private/ssl-cert-snakeoil.key` | V·ªã tr√≠ file **private key** cho SSL/TLS.                                     |
           | `ssl_enable=NO`                                               | B·∫≠t/T·∫Øt **SSL/TLS** cho FTP (NO = ch∆∞a b·∫≠t).                                 |


           üëâ Hi·ªÉu nhanh:
                      C√°c option *_enable ‚Üí cho ph√©p/t·∫Øt t√≠nh nƒÉng.
                      C√°c option rsa_* ‚Üí d√πng cho FTPS (FTP Secure).
                      listen + listen_ipv6 ‚Üí quy·∫øt ƒë·ªãnh c√°ch vsftpd ch·∫°y (daemon, IPv4/IPv6).
                      secure_chroot_dir ‚Üí tƒÉng b·∫£o m·∫≠t b·∫±ng sandbox.

FTPUSERS
           In addition, there is a file called /etc/ftpusers that we also need to pay attention to, as this file is used to deny certain users access to the FTP service. In the following example, the users guest, john, and kevin are not permitted to log in to the FTP service, even if they exist on the Linux system.
           naruto3co@htb[/htb]$ cat /etc/ftpusers
                      guest
                      john
                      kevin

           -> t·ª´ ch·ªëi 3 user kh√¥ng ƒë∆∞·ª£c s·ª≠ d·ª•ng d·ªãch v·ª• 

Dangerous Settings
           | **Setting**                    | **Description (√ù nghƒ©a)**                                                                                     |
           | ------------------------------ | ------------------------------------------------------------------------------------------------------------- |
           | `anonymous_enable=YES`         | Cho ph√©p **ng∆∞·ªùi d√πng anonymous** ƒëƒÉng nh·∫≠p (kh√¥ng c·∫ßn t√†i kho·∫£n h·ªá th·ªëng).                                   |
           | `anon_upload_enable=YES`       | Cho ph√©p anonymous **upload file** v√†o th∆∞ m·ª•c ƒë√£ ƒë∆∞·ª£c c·∫•u h√¨nh cho ph√©p ghi (nguy hi·ªÉm n·∫øu kh√¥ng ki·ªÉm so√°t). |
           | `anon_mkdir_write_enable=YES`  | Cho ph√©p anonymous **t·∫°o th∆∞ m·ª•c m·ªõi**.                                                                       |
           | `no_anon_password=YES`         | Kh√¥ng y√™u c·∫ßu password khi login v·ªõi anonymous (ch·ªâ c·∫ßn nh·∫≠p b·∫•t k·ª≥ ho·∫∑c ƒë·ªÉ tr·ªëng).                           |
           | `anon_root=/home/username/ftp` | ƒê·∫∑t th∆∞ m·ª•c g·ªëc (root) cho ng∆∞·ªùi d√πng anonymous. Khi login, h·ªç ch·ªâ th·∫•y v√† thao t√°c trong th∆∞ m·ª•c n√†y.        |
           | `write_enable=YES`             | Cho ph√©p c√°c l·ªánh ghi/ch·ªânh s·ª≠a nh∆∞:                                                                          |

           STOR (upload file)
           DELE (x√≥a file)
           RNFR/RNTO (ƒë·ªïi t√™n file)
           MKD (t·∫°o th∆∞ m·ª•c)
           RMD (x√≥a th∆∞ m·ª•c)
           APPE (append d·ªØ li·ªáu v√†o file)
           SITE (ch·∫°y m·ªôt s·ªë l·ªánh site-specific) |

           üëâ T√≥m g·ªçn:
           N·∫øu b·∫≠t anonymous_enable=YES + write_enable=YES + anon_upload_enable=YES th√¨ b·∫•t k·ª≥ ai c≈©ng c√≥ th·ªÉ upload/xo√° file trong th∆∞ m·ª•c anon_root.
           ƒê√¢y l√† r·ªßi ro b·∫£o m·∫≠t l·ªõn, th∆∞·ªùng ch·ªâ d√πng trong m√¥i tr∆∞·ªùng n·ªôi b·ªô ho·∫∑c public repository read-only.



Anonymous Login
           naruto3co@htb[/htb]$ ftp 10.129.14.136
           
           Connected to 10.129.14.136.
           220 "Welcome to the HTB Academy vsFTP service."
           Name (10.129.14.136:cry0l1t3): anonymous

vsFTPd Status
           ftp> status

vsFTPd Detailed Output
           ftp> debug
           ftp> trace

           ƒê·ªÉ n√≥ hi·ªán th√™m ƒë·∫ßy ƒë·ªß th√¥ng tin h∆°n khi b·∫≠t 2 mode n√†y 

C·∫•u h√¨nh li√™n quan ƒë·∫øn directory & quy·ªÅn ng∆∞·ªùi d√πng
           | **Setting**               | **Description (√ù nghƒ©a)**                                                                                                                                                    |
           | ------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
           | `dirmessage_enable=YES`   | Khi user truy c·∫≠p v√†o th∆∞ m·ª•c, n·∫øu th∆∞ m·ª•c ƒë√≥ c√≥ file `.message` th√¨ n·ªôi dung file s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã (gi·ªëng banner/notice).                                                   |
           | `chown_uploads=YES`       | T·∫•t c·∫£ file **anonymous upload** s·∫Ω t·ª± ƒë·ªông ƒë·ªïi quy·ªÅn s·ªü h·ªØu sang user x√°c ƒë·ªãnh trong `chown_username`.                                                                      |
           | `chown_username=username` | X√°c ƒë·ªãnh user h·ªá th·ªëng s·∫Ω ƒë∆∞·ª£c g√°n l√†m ch·ªß s·ªü h·ªØu c√°c file anonymous upload.                                                                                                 |
           | `local_enable=YES`        | Cho ph√©p **local users** (c√°c t√†i kho·∫£n c√≥ trong `/etc/passwd`) ƒëƒÉng nh·∫≠p FTP.                                                                                               |
           | `chroot_local_user=YES`   | Khi b·∫≠t, **m·ªçi local user** b·ªã ‚Äúchroot jail‚Äù trong th∆∞ m·ª•c home c·ªßa h·ªç ‚Üí kh√¥ng th·ªÉ truy c·∫≠p ra ngo√†i (tƒÉng b·∫£o m·∫≠t).                                                         |
           | `chroot_list_enable=YES`  | K√≠ch ho·∫°t danh s√°ch chroot. S·∫Ω c√≥ file `chroot_list_file` (m·∫∑c ƒë·ªãnh `/etc/vsftpd.chroot_list`) ƒë·ªÉ quy ƒë·ªãnh **user n√†o b·ªã/kh√¥ng b·ªã chroot** t√πy c·∫•u h√¨nh `chroot_local_user`. |

C√°c t√πy ch·ªçn hi·ªÉn th·ªã & li·ªát k√™
           | **Setting**             | **Description (√ù nghƒ©a)**                                                                                   |
           | ----------------------- | ----------------------------------------------------------------------------------------------------------- |
           | `hide_ids=YES`          | Trong k·∫øt qu·∫£ `ls -l`, t·∫•t c·∫£ UID/GID s·∫Ω hi·ªÉn th·ªã l√† **ftp** thay v√¨ t√™n th·∫≠t ‚Üí ·∫©n th√¥ng tin user h·ªá th·ªëng. |
           | `ls_recurse_enable=YES` | Cho ph√©p user d√πng l·ªánh `ls -R` ƒë·ªÉ li·ªát k√™ th∆∞ m·ª•c con ƒë·ªá quy.                                              |

T√≥m g·ªçn:
           chroot_*: ki·ªÉm so√°t vi·ªác nh·ªët user trong home directory ‚Üí ngƒÉn r·ªßi ro l·ªô d·ªØ li·ªáu ngo√†i ph·∫°m vi cho ph√©p.
           chown_*: ki·ªÉm so√°t quy·ªÅn s·ªü h·ªØu file khi anonymous upload.
           hide_ids: che gi·∫•u th√¥ng tin th·∫≠t v·ªÅ user/group.
           ls_recurse_enable: ch·ªâ n√™n b·∫≠t khi th·ª±c s·ª± c·∫ßn, v√¨ c√≥ th·ªÉ l√†m l·ªô c·∫•u tr√∫c th∆∞ m·ª•c.


Hiding IDs - YES
           ftp> ls

           T√πy ch·ªçn nh∆∞ hide_ids=YES trong vsftpd gi√∫p kh√¥ng hi·ªÉn th·ªã t√™n th·∫≠t c·ªßa user/group trong k·∫øt qu·∫£ li·ªát k√™ th∆∞ m·ª•c (ls -l).
           N·∫øu l·ªô username, k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng ƒë·ªÉ th·ª≠ brute-force v√†o c√°c d·ªãch v·ª• nh∆∞ FTP, SSH.
           C√°c h·ªá th·ªëng th∆∞·ªùng k·∫øt h·ª£p v·ªõi fail2ban ho·∫∑c c√°c gi·∫£i ph√°p t∆∞∆°ng t·ª± ‚Üí t·ª± ƒë·ªông block IP sau nhi·ªÅu l·∫ßn ƒëƒÉng nh·∫≠p sai, gi·∫£m nguy c∆° brute-force.
           üëâ  hide_ids = tƒÉng b·∫£o m·∫≠t, tr√°nh l·ªô username.

ls_recurse_enable=YES
           Cho ph√©p ng∆∞·ªùi d√πng ch·∫°y ls -R ƒë·ªÉ li·ªát k√™ to√†n b·ªô c√¢y th∆∞ m·ª•c b√™n trong FTP.
           Gi√∫p c√≥ c√°i nh√¨n t·ªïng quan nhanh h∆°n v·ªÅ c·∫•u tr√∫c th∆∞ m·ª•c, th·∫•y ƒë∆∞·ª£c t·∫•t c·∫£ n·ªôi dung kh·∫£ d·ª•ng m·ªôt l·∫ßn.
           L∆∞u √Ω: 
                      Ti·ªán l·ª£i cho qu·∫£n tr·ªã, nh∆∞ng c√≥ th·ªÉ khi·∫øn l·ªô nhi·ªÅu th√¥ng tin v·ªÅ c·∫•u tr√∫c h·ªá th·ªëng cho attacker n·∫øu server cho ph√©p qu√° nhi·ªÅu ng∆∞·ªùi d√πng truy c·∫≠p.
                      Th∆∞·ªùng ch·ªâ b·∫≠t trong m√¥i tr∆∞·ªùng n·ªôi b·ªô ho·∫∑c cho nh√≥m user ƒë√°ng tin c·∫≠y.

           üëâ T√≥m g·ªçn: ls_recurse_enable = ti·ªán l·ª£i ƒë·ªÉ xem to√†n b·ªô c·∫•u tr√∫c th∆∞ m·ª•c FTP, nh∆∞ng c·∫ßn c√¢n nh·∫Øc khi b·∫≠t trong m√¥i tr∆∞·ªùng public.

Download file
           ftp> ls
           200 PORT command successful. Consider using PASV.
           150 Here comes the directory listing.
           -rwxrwxrwx    1 ftp      ftp             0 Sep 16 17:24 Calendar.pptx
           drwxrwxrwx    4 ftp      ftp          4096 Sep 16 17:57 Clients
           drwxrwxrwx    2 ftp      ftp          4096 Sep 16 18:05 Documents
           drwxrwxrwx    2 ftp      ftp          4096 Sep 16 17:24 Employees
           -rwxrwxrwx    1 ftp      ftp            41 Sep 18 15:58 Important Notes.txt
           226 Directory send OK.
           
           
           ftp> get Important\ Notes.txt
           local: Important Notes.txt remote: Important Notes.txt
           200 PORT command successful. Consider using PASV.
           150 Opening BINARY mode data connection for Important Notes.txt (41 bytes).
           226 Transfer complete.
           41 bytes received in 0.00 secs (606.6525 kB/s)
           
           ftp> exit
           221 Goodbye.
  
           naruto3co@htb[/htb]$ ls | grep Notes.txt
                      'Important Notes.txt'



Download All Available Files
           naruto3co@htb[/htb]$ wget -m --no-passive ftp://anonymous:anonymous@10.129.14.136




‚ñà‚ñà‚ïó‚ñë‚ñë‚ñë‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñà‚ñà‚ïó‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë
‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó
‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñà‚ñà‚ïë
‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïù‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñà‚ñà‚ïë
‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù
‚ñë‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ñë‚ïö‚ïê‚ïù‚ñë‚ñë‚ñë‚ñë‚ñë‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ñë‚ïö‚ïê‚ïê‚ïê‚ïê‚ïù‚ñë‚ïö‚ïê‚ïù‚ñë‚ñë‚ïö‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ñë


           N·∫øu FTP cho ph√©p upload v√†o th∆∞ m·ª•c ƒë∆∞·ª£c webserver ph·ª•c v·ª•, kh·∫£ nƒÉng k·∫ª t·∫•n c√¥ng upload m√£ ƒë·ªôc (webshell, script) v√† th·ª±c thi tr√™n server l√† hi·ªán h·ªØu ‚Üí r·∫•t nguy hi·ªÉm.
           Nhi·ªÅu l·ªói l√† do config l·ªèng l·∫ªo (anonymous upload, th∆∞ m·ª•c upload r∆°i v√†o webroot, quy·ªÅn file th∆∞ m·ª•c sai, kh√¥ng chroot user, v.v.) ho·∫∑c do admin tin t∆∞·ªüng ‚Äúm·∫°ng n·ªôi b·ªô an to√†n‚Äù ‚Üí b·ªè qua hardening.

           ftp> put testupload.txt 

Footprinting the Service
Nguy√™n t·∫Øc nhanh
           N·∫øu FTP cho ph√©p upload v√†o th∆∞ m·ª•c ƒë∆∞·ª£c webserver ph·ª•c v·ª•, kh·∫£ nƒÉng k·∫ª t·∫•n c√¥ng upload m√£ ƒë·ªôc (webshell, script) v√† th·ª±c thi tr√™n server l√† hi·ªán h·ªØu ‚Üí r·∫•t nguy hi·ªÉm.
           Nhi·ªÅu l·ªói l√† do config l·ªèng l·∫ªo (anonymous upload, th∆∞ m·ª•c upload r∆°i v√†o webroot, quy·ªÅn file th∆∞ m·ª•c sai, kh√¥ng chroot user, v.v.) ho·∫∑c do admin tin t∆∞·ªüng ‚Äúm·∫°ng n·ªôi b·ªô an to√†n‚Äù ‚Üí b·ªè qua hardening.


‚ï≠‚îÅ‚îÅ‚îÅ‚ïÆ‚ï±‚ï±‚ï±‚ï±‚ï±‚ï≠‚ïÆ‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï≠‚ïÆ
‚îÉ‚ï≠‚îÅ‚îÅ‚ïØ‚ï±‚ï±‚ï±‚ï±‚ï≠‚ïØ‚ï∞‚ïÆ‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï≠‚ïØ‚ï∞‚ïÆ
‚îÉ‚ï∞‚îÅ‚îÅ‚î≥‚îÅ‚îÅ‚î≥‚îÅ‚îª‚ïÆ‚ï≠‚ïã‚îÅ‚îÅ‚î≥‚îÅ‚î≥‚î≥‚îÅ‚ïã‚ïÆ‚ï≠‚ïã‚î≥‚îÅ‚ïÆ‚ï≠‚îÅ‚îÅ‚ïÆ
‚îÉ‚ï≠‚îÅ‚îÅ‚î´‚ï≠‚ïÆ‚îÉ‚ï≠‚ïÆ‚îÉ‚îÉ‚îÉ‚ï≠‚ïÆ‚îÉ‚ï≠‚ïã‚î´‚ï≠‚ïÆ‚î´‚îÉ‚î£‚î´‚ï≠‚ïÆ‚î´‚ï≠‚ïÆ‚îÉ
‚îÉ‚îÉ‚ï±‚ï±‚îÉ‚ï∞‚ïØ‚îÉ‚ï∞‚ïØ‚îÉ‚ï∞‚î´‚ï∞‚ïØ‚îÉ‚îÉ‚îÉ‚îÉ‚îÉ‚îÉ‚îÉ‚ï∞‚î´‚îÉ‚îÉ‚îÉ‚îÉ‚ï∞‚ïØ‚îÉ
‚ï∞‚ïØ‚ï±‚ï±‚ï∞‚îÅ‚îÅ‚îª‚îÅ‚îÅ‚îª‚îÅ‚î´‚ï≠‚îÅ‚îª‚ïØ‚ï∞‚îª‚ïØ‚ï∞‚îª‚îÅ‚îª‚îª‚ïØ‚ï∞‚îª‚îÅ‚ïÆ‚îÉ
‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚îÉ‚îÉ‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï≠‚îÅ‚ïØ‚îÉ
‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï∞‚ïØ‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï±‚ï∞‚îÅ‚îÅ‚ïØ...

           naruto3co@htb[/htb]$ sudo nmap --script-updatedb
           
           naruto3co@htb[/htb]$ find / -type f -name ftp* 2>/dev/null | grep scripts
                      Ta list ƒë∆∞·ª£c danh s√°ch script 
           
           naruto3co@htb[/htb]$ sudo nmap -sV -p21 -sC -A 10.129.14.136


Service Interaction

naruto3co@htb[/htb]$ nc -nv 10.129.14.136 21
naruto3co@htb[/htb]$ telnet 10.129.14.136 21








