# TÃ³m Táº¯t ToÃ n Bá»™ Kiáº¿n Thá»©c Vá» Tamper Trong SQLMap

## ðŸ“Œ Tamper lÃ  gÃ¬?

**Tamper** trong sqlmap lÃ  cÃ¡c script dÃ¹ng Ä‘á»ƒ **biáº¿n Ä‘á»•i payload SQL** Ä‘á»ƒ:

* Bypass **WAF / Firewall / IDS / IPS**
* VÆ°á»£t qua **filter Ä‘Æ¡n giáº£n hoáº·c regex cháº·n tá»« khÃ³a**
* Che giáº¥u hoáº·c encode payload
* Fix lá»—i cÃº phÃ¡p (syntax) khi server yÃªu cáº§u format Ä‘áº·c biá»‡t

âž¡ **Tamper = CÃ¡ch sqlmap "ngá»¥y trang" payload Ä‘á»ƒ khai thÃ¡c SQLi trong mÃ´i trÆ°á»ng bá»‹ báº£o vá»‡.**

---

# ðŸ“Œ CÃ¡c NhÃ³m Tamper Quan Trá»ng

## ðŸŸ¦ 1. Tamper liÃªn quan tá»›i khoáº£ng tráº¯ng (whitespace tampering)

| Tamper                | CÃ´ng dá»¥ng                                              |
| --------------------- | ------------------------------------------------------ |
| **space2comment**     | Äá»•i space thÃ nh `/**/` Ä‘á»ƒ bypass WAF cháº·n khoáº£ng tráº¯ng |
| **space2plus**        | Äá»•i space thÃ nh `+`                                    |
| **space2dash**        | Äá»•i space thÃ nh `--`                                   |
| **space2tab**         | Äá»•i space thÃ nh tab                                    |
| **space2randomblank** | DÃ¹ng kÃ½ tá»± tráº¯ng ngáº«u nhiÃªn                            |
| **space2mssqlblank**  | Whitespace dáº¡ng MSSQL                                  |

---

## ðŸŸ¦ 2. Tamper thay Ä‘á»•i cÃº phÃ¡p / logic SQL

| Tamper                        | CÃ´ng dá»¥ng                                              |
| ----------------------------- | ------------------------------------------------------ |
| **between**                   | Biáº¿n Ä‘iá»u kiá»‡n thÃ nh dáº¡ng `BETWEEN` Ä‘á»ƒ trÃ¡nh bá»‹ detect |
| **equaltolike**               | Chuyá»ƒn `=` thÃ nh `LIKE`                                |
| **greater**                   | DÃ¹ng `>` hoáº·c `<` thay vÃ¬ `=`                          |
| **versionedkeywords**         | ChÃ¨n comment vÃ o keyword (`/*!SELECT*/`)               |
| **versionedmorekeywords**     | Biáº¿n thá»ƒ máº¡nh hÆ¡n cá»§a versionedkeywords                |
| **modsecurityversioned**      | Bypass ModSecurity                                     |
| **halfversionedmorekeywords** | áº¨n keyword báº±ng ká»¹ thuáº­t comment                       |

---

## ðŸŸ¦ 3. Tamper dáº¡ng mÃ£ hÃ³a / obfuscation

| Tamper                | CÃ´ng dá»¥ng                                 |
| --------------------- | ----------------------------------------- |
| **randomcase**        | Viáº¿t hoa/thÆ°á»ng ngáº«u nhiÃªn â†’ bypass regex |
| **charencode**        | Encode kÃ½ tá»± ASCII                        |
| **charunicodeescape** | Encode Unicode â†’ bypass WAF máº¡nh          |
| **base64encode**      | Encode payload dáº¡ng Base64                |
| **apostrophemask**    | MÃ£ hÃ³a dáº¥u `'`                            |
| **escapequotes**      | Escape dáº¥u `'` hoáº·c `"`                   |
| **doubleencode**      | URL encode 2 láº§n                          |
| **urlencode**         | Encode dáº¡ng URL                           |
| **percentage**        | Encode `%` â†’ `%25`                        |
| **hexencode**         | Chuyá»ƒn chuá»—i thÃ nh hex                    |

---

## ðŸŸ¦ 4. Tamper dÃ nh riÃªng cho tá»«ng DBMS

| Tamper                | DBMS                 | CÃ´ng dá»¥ng                     |
| --------------------- | -------------------- | ----------------------------- |
| **charunicodeescape** | MySQL/PostgreSQL     | Encode Unicode                |
| **commaless**         | MySQL                | Payload khÃ´ng dÃ¹ng dáº¥u `,`    |
| **ifnull2ifisnull**   | MySQL                | Chuyá»ƒn IFNULL â†’ IF(ISNULL())  |
| **ord2ascii**         | PostgreSQL           | Äá»•i `ORD()` â†’ `ASCII()`       |
| **sp_password**       | MSSQL                | Bypass tá»« khÃ³a nháº¡y cáº£m       |
| **bluecoat**          | MSSQL & BlueCoat WAF | Che giáº¥u keyword              |
| **overlongutf8**      | MySQL                | Bypass WAF báº±ng UTF-8 kÃ©o dÃ i |

---

# ðŸ“Œ TÃ¬nh Huá»‘ng NÃªn DÃ¹ng Tamper

* Khi bá»‹ **WAF block** payload bÃ¬nh thÆ°á»ng
* Khi payload cÃ³ tá»« khÃ³a nháº¡y: `AND`, `UNION`, `SELECT`, `SLEEP`, ...
* Khi filter chá»‰ cháº¥p nháº­n vÃ i kÃ½ tá»± nháº¥t Ä‘á»‹nh
* Khi server tá»± Ä‘á»™ng sá»­a payload â†’ cáº§n lÃ m payload "dá»‹"
* Khi muá»‘n nÃ© signature cá»§a IDS/IPS

---

# ðŸ“Œ CÃ¡c Combo Tamper Máº¡nh Trong Pentest

| Má»¥c Ä‘Ã­ch                   | Combo khuyáº¿n nghá»‹                        |
| -------------------------- | ---------------------------------------- |
| Bypass WAF trung bÃ¬nh      | `space2comment, between, randomcase`     |
| Bypass WAF máº¡nh            | `charunicodeescape, randomcase, between` |
| Bypass filter khoáº£ng tráº¯ng | `space2plus` hoáº·c `space2comment`        |
| Blind SQLi khÃ³             | `equaltolike, greater, between`          |

---

# ðŸ“Œ Káº¿t luáº­n

* Sqlmap cÃ³ **hÆ¡n 40 tamper scripts** â†’ khÃ´ng cáº§n dÃ¹ng háº¿t, chá»‰ dÃ¹ng tÃ¹y tÃ¬nh huá»‘ng.
* Tamper **khÃ´ng táº¡o lá»— há»•ng**, chá»‰ giÃºp **payload khÃ´ng bá»‹ cháº·n**.
* Káº¿t há»£p tamper Ä‘Ãºng cÃ¡ch giÃºp **bypass WAF hiá»‡u quáº£** vÃ  **dÃ² nhanh hÆ¡n**.

---

**File nÃ y tá»•ng há»£p toÃ n bá»™ kiáº¿n thá»©c thá»ƒ hiá»‡n trong dá»± Ã¡n HackTheBox CPTS vá» tamper trong sqlmap â€“ gá»n, Ä‘á»§, dá»… nhá»›.**
