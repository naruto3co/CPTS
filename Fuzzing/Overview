Tóm tắt – Attacking Web Applications with Ffuf
  Mục tiêu: học cách fuzzing (tìm kiếm, brute-force) các thành phần web ứng dụng bằng công cụ ffuf.
  Ffuf là công cụ phổ biến, tin cậy để fuzzing web.
🔑 Các chủ đề được đề cập:
  Directory fuzzing – tìm thư mục ẩn.
  File & extension fuzzing – tìm file và các phần mở rộng.
  Hidden vhosts – phát hiện virtual host ẩn.
  PHP parameter fuzzing – tìm tham số PHP.
  Parameter value fuzzing – thử giá trị của tham số.
🔑 Cách hoạt động cơ bản:
  Dùng wordlist gửi request đến webserver.
  Nếu server trả về HTTP 200 (OK) → trang/tham số đó tồn tại và có thể kiểm tra thủ công.






locate directory-list-2.3-small.txt

ffuf -w /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ
ffuf -w /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/blog/FUZZ.php

Nếu tình thấy thư mục thì đi tiếp sâu bên trong 1 cấp, ngoài thư mục thì thử thêm extension -e .php . chế độ verbose -v chỉ in kết quả 
ffuf -w /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ -recursion -recursion-depth 1 -e .php -v




| **Command**                                                                                                                                                     | **Description**                            |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------ |
| `ffuf -h`                                                                                                                                                       | Hiển thị help.                             |
| `ffuf -w wordlist.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ`                                                                                                       | Directory fuzzing (tìm thư mục).           |
| `ffuf -w wordlist.txt:FUZZ -u http://SERVER_IP:PORT/indexFUZZ`                                                                                                  | Extension fuzzing (tìm phần mở rộng file). |
| `ffuf -w wordlist.txt:FUZZ -u http://SERVER_IP:PORT/blog/FUZZ.php`                                                                                              | Page fuzzing (tìm file cụ thể).            |
| `ffuf -w wordlist.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ -recursion -recursion-depth 1 -e .php -v`                                                              | Recursive fuzzing (lặp sâu thư mục).       |
| `ffuf -w wordlist.txt:FUZZ -u https://FUZZ.hackthebox.eu/`                                                                                                      | Sub-domain fuzzing.                        |
| `ffuf -w wordlist.txt:FUZZ -u http://academy.htb:PORT/ -H 'Host: FUZZ.academy.htb' -fs xxx`                                                                     | VHost fuzzing (Host header injection).     |
| `ffuf -w wordlist.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php?FUZZ=key -fs xxx`                                                                   | Parameter fuzzing – GET.                   |
| `ffuf -w wordlist.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'FUZZ=key' -H 'Content-Type: application/x-www-form-urlencoded' -fs xxx` | Parameter fuzzing – POST.                  |
| `ffuf -w ids.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'id=FUZZ' -H 'Content-Type: application/x-www-form-urlencoded' -fs xxx`       | Value fuzzing (fuzz giá trị parameter).    |
| `/opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt`                                                                                       | Wordlist thư mục/trang.                    |
| `/opt/useful/seclists/Discovery/Web-Content/web-extensions.txt`                                                                                                 | Wordlist extension file.                   |
| `/opt/useful/seclists/Discovery/DNS/subdomains-top1million-5000.txt`                                                                                            | Wordlist sub-domain.                       |
| `/opt/useful/seclists/Discovery/Web-Content/burp-parameter-names.txt`                                                                                           | Wordlist parameter.                        |
| `sudo sh -c 'echo "SERVER_IP academy.htb" >> /etc/hosts'`                                                                                                       | Thêm DNS entry vào `/etc/hosts`.           |
| `for i in $(seq 1 1000); do echo $i >> ids.txt; done`                                                                                                           | Tạo wordlist số (1–1000).                  |
| `curl http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'id=key' -H 'Content-Type: application/x-www-form-urlencoded'`                                   | Gửi POST request thủ công với curl.        |



Tìm subdomain 
ffuf -w /opt/useful/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://FUZZ.academy.htb/


Tìm VHOST 

Bối cảnh
  Bạn tìm thấy một server có IP: 10.10.10.10
  Khi truy cập http://10.10.10.10 trên trình duyệt → chỉ thấy trang mặc định (nghèo nàn, không hữu ích).
  Bạn nghi ngờ server này có nhiều VHost ẩn.

Chạy lệnh fuzzing
  ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://10.10.10.10/ -H "Host: FUZZ.10.10.10.10"
Hoặc nếu biết domain chính là example.com:
  ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://10.10.10.10/ -H "Host: FUZZ.example.com"



🔎 Quy trình tìm và truy cập VHost ẩn
Xác định IP server
  Từ DNS public của domain chính (academy.htb → 10.10.10.10)
  Hoặc từ scan (nmap, dig, ping, recon khác).
👉 Đây là IP duy nhất server đang chạy.
Fuzz VHost trên IP đó
  Dùng ffuf với -H "Host: FUZZ.academy.htb" gửi request đến http://10.10.10.10/.
  Nếu header Host khớp với VHost tồn tại → server trả về nội dung khác biệt.
Phát hiện domain ẩn
  Ví dụ tìm thấy admin.academy.htb
Thêm domain vào /etc/hosts
  Bởi vì DNS public không biết admin.academy.htb là gì.
  Ta buộc phải map thủ công:
    10.10.10.10  admin.academy.htb
Truy cập trực tiếp
  Giờ chỉ cần gõ http://admin.academy.htb trên trình duyệt → request sẽ đi tới IP 10.10.10.10, với Host header đúng → server trả về site admin.
👉 Tóm lại: Đầu tiên phải biết IP → fuzz VHost trên IP đó → phát hiện domain ẩn → thêm vào /etc/hosts → truy cập được.

Cấu hình /etc/hosts với IP và domain

Giả sử IP của server là 10.10.10.10, bạn sẽ thêm:
  10.10.10.10   example.com
  10.10.10.10   www.example.com
  10.10.10.10   admin.example.com
  10.10.10.10   intranet.example.com




Filtering Results
Filter size là 900
  naruto3co@htb[/htb]$ ffuf -w /opt/useful/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:PORT/ -H 'Host: FUZZ.academy.htb' -fs 900




